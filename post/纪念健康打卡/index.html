<!doctype html>
<html lang="en-us">
  <head>
    <title>纪念健康打卡 // 洛七的摸鱼池塘</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.115.4">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="洛七" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.d08c6ce68432c68a64d84cb426dfdecab702035f91a5d580831f23f76c040a05.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="纪念健康打卡"/>
<meta name="twitter:description" content="疫情管控放开了，学校也终于取消健康打卡了，之前写的自动化健康打卡也用不到了，记录一下这个健康打卡引用中遇到的两个新问题
这里的代码是用selenium实现的，因为懒，不想再分析请求了
第一个问题：如何发送邮件
from email.mime.text import MIMEText #纯文本，HTML from email.mime.image import MIMEImage #图片 from email.mime.multipart import MIMEMultipart #多种组合内容 # smtplib 用于邮件的发信动作 import smtplib # email 用于构建邮件内容 from email.mime.text import MIMEText # 构建邮件头 from email.header import Header def sendMail(status): # 发信方的信息：发信邮箱，QQ 邮箱授权码 # 发送方邮箱 from_addr = &#39;xxxxx@qq.com&#39; # 发送方的QQ邮箱授权码 password = &#39;asdfghjkl&#39; # 收信方邮箱 to_addr = &#39;yyyyyy@qq.com&#39; # 发信服务器 # QQ那边设置 smtp_server = &#39;smtp.qq.com&#39; # 邮箱正文内容，第一个参数为内容，第二个参数为格式(plain 为纯文本)，第三个参数为编码 msg = MIMEText(&#39;恭喜你今天的打卡完成啦！&#39;, &#39;plain&#39;, &#39;utf-8&#39;) # 邮件头信息 msg[&#39;From&#39;] = Header(&#39;打卡小助手&#39;) # 发送者 msg[&#39;To&#39;] = Header(&#39;洛七&#39;) # 接收者 subject = &#39;【健康打卡】&#39;&#43;status msg[&#39;Subject&#39;] = Header(subject, &#39;utf-8&#39;) # 邮件主题 try: smtpobj = smtplib."/>

    <meta property="og:title" content="纪念健康打卡" />
<meta property="og:description" content="疫情管控放开了，学校也终于取消健康打卡了，之前写的自动化健康打卡也用不到了，记录一下这个健康打卡引用中遇到的两个新问题
这里的代码是用selenium实现的，因为懒，不想再分析请求了
第一个问题：如何发送邮件
from email.mime.text import MIMEText #纯文本，HTML from email.mime.image import MIMEImage #图片 from email.mime.multipart import MIMEMultipart #多种组合内容 # smtplib 用于邮件的发信动作 import smtplib # email 用于构建邮件内容 from email.mime.text import MIMEText # 构建邮件头 from email.header import Header def sendMail(status): # 发信方的信息：发信邮箱，QQ 邮箱授权码 # 发送方邮箱 from_addr = &#39;xxxxx@qq.com&#39; # 发送方的QQ邮箱授权码 password = &#39;asdfghjkl&#39; # 收信方邮箱 to_addr = &#39;yyyyyy@qq.com&#39; # 发信服务器 # QQ那边设置 smtp_server = &#39;smtp.qq.com&#39; # 邮箱正文内容，第一个参数为内容，第二个参数为格式(plain 为纯文本)，第三个参数为编码 msg = MIMEText(&#39;恭喜你今天的打卡完成啦！&#39;, &#39;plain&#39;, &#39;utf-8&#39;) # 邮件头信息 msg[&#39;From&#39;] = Header(&#39;打卡小助手&#39;) # 发送者 msg[&#39;To&#39;] = Header(&#39;洛七&#39;) # 接收者 subject = &#39;【健康打卡】&#39;&#43;status msg[&#39;Subject&#39;] = Header(subject, &#39;utf-8&#39;) # 邮件主题 try: smtpobj = smtplib." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://Lu0key.github.io/post/%E7%BA%AA%E5%BF%B5%E5%81%A5%E5%BA%B7%E6%89%93%E5%8D%A1/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-01-07T23:24:14+08:00" />
<meta property="article:modified_time" content="2023-01-07T23:24:14+08:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://Lu0key.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="洛七" /></a>
      <span class="app-header-title">洛七的摸鱼池塘</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/tags/">Tags</a>
      </nav>
      <p>即将没书读的咸鱼</p>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">纪念健康打卡</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jan 7, 2023
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://Lu0key.github.io/tags/%E7%88%AC%E8%99%AB/">爬虫</a>
              <a class="tag" href="https://Lu0key.github.io/tags/selenium/">selenium</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <p>疫情管控放开了，学校也终于取消健康打卡了，之前写的自动化健康打卡也用不到了，记录一下这个健康打卡引用中遇到的两个新问题</p>
<p>这里的代码是用selenium实现的，因为懒，不想再分析请求了</p>
<p>第一个问题：如何发送邮件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> email.mime.text <span style="color:#f92672">import</span> MIMEText  <span style="color:#75715e">#纯文本，HTML</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> email.mime.image <span style="color:#f92672">import</span> MIMEImage <span style="color:#75715e">#图片</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> email.mime.multipart <span style="color:#f92672">import</span> MIMEMultipart <span style="color:#75715e">#多种组合内容</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># smtplib 用于邮件的发信动作</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> smtplib
</span></span><span style="display:flex;"><span><span style="color:#75715e"># email 用于构建邮件内容</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> email.mime.text <span style="color:#f92672">import</span> MIMEText
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 构建邮件头</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> email.header <span style="color:#f92672">import</span> Header
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sendMail</span>(status):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 发信方的信息：发信邮箱，QQ 邮箱授权码</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 发送方邮箱</span>
</span></span><span style="display:flex;"><span>    from_addr <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;xxxxx@qq.com&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 发送方的QQ邮箱授权码</span>
</span></span><span style="display:flex;"><span>    password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;asdfghjkl&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 收信方邮箱</span>
</span></span><span style="display:flex;"><span>    to_addr <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;yyyyyy@qq.com&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 发信服务器</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># QQ那边设置</span>
</span></span><span style="display:flex;"><span>    smtp_server <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;smtp.qq.com&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 邮箱正文内容，第一个参数为内容，第二个参数为格式(plain 为纯文本)，第三个参数为编码</span>
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> MIMEText(<span style="color:#e6db74">&#39;恭喜你今天的打卡完成啦！&#39;</span>, <span style="color:#e6db74">&#39;plain&#39;</span>, <span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 邮件头信息</span>
</span></span><span style="display:flex;"><span>    msg[<span style="color:#e6db74">&#39;From&#39;</span>] <span style="color:#f92672">=</span> Header(<span style="color:#e6db74">&#39;打卡小助手&#39;</span>)  <span style="color:#75715e"># 发送者</span>
</span></span><span style="display:flex;"><span>    msg[<span style="color:#e6db74">&#39;To&#39;</span>] <span style="color:#f92672">=</span> Header(<span style="color:#e6db74">&#39;洛七&#39;</span>)  <span style="color:#75715e"># 接收者</span>
</span></span><span style="display:flex;"><span>    subject <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;【健康打卡】&#39;</span><span style="color:#f92672">+</span>status
</span></span><span style="display:flex;"><span>    msg[<span style="color:#e6db74">&#39;Subject&#39;</span>] <span style="color:#f92672">=</span> Header(subject, <span style="color:#e6db74">&#39;utf-8&#39;</span>)  <span style="color:#75715e"># 邮件主题</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        smtpobj <span style="color:#f92672">=</span> smtplib<span style="color:#f92672">.</span>SMTP_SSL(smtp_server)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 建立连接--qq邮箱服务和端口号（可百度查询）</span>
</span></span><span style="display:flex;"><span>        smtpobj<span style="color:#f92672">.</span>connect(smtp_server, <span style="color:#ae81ff">465</span>)    
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 登录--发送者账号和口令</span>
</span></span><span style="display:flex;"><span>        smtpobj<span style="color:#f92672">.</span>login(from_addr, password)   
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 发送邮件</span>
</span></span><span style="display:flex;"><span>        smtpobj<span style="color:#f92672">.</span>sendmail(from_addr, to_addr, msg<span style="color:#f92672">.</span>as_string()) 
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;邮件发送成功&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> smtplib<span style="color:#f92672">.</span>SMTPException:
</span></span><span style="display:flex;"><span>        print()
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;无法发送邮件&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">finally</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 关闭服务器</span>
</span></span><span style="display:flex;"><span>        smtpobj<span style="color:#f92672">.</span>quit()
</span></span></code></pre></div><p>这里会发现需要有一个QQ来发送，一个QQ来接收<br>
（但是我没试过可不可以发送和接收是同一个QQ，也不一定要QQ邮箱，其他应该都可以）</p>
<blockquote>
<p>QQ授权码和QQ密码不一样</p>
</blockquote>
<p>第二个问题：需要点击的按钮在div中，需要拉动滚动条，selenium没有办法点击要怎么办？</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 找到指定的元素</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (我是在控制台试了好多次才找到的指定元素)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 创建js语句，使用scrollTop去移动页面，这里因为是最下面，所以直接拉满了</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 执行js语句</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 移动页面！</span>
</span></span><span style="display:flex;"><span>js_dowmpage <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;document.querySelector(&#34;.preview-container &gt; div &gt; div &gt; div.preview-page &gt; #pdfDomContent&#34;).scrollTop = 10000 &#39;</span>
</span></span><span style="display:flex;"><span>browser<span style="color:#f92672">.</span>execute_script(js_dowmpage)
</span></span></code></pre></div><p>完整代码如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> selenium <span style="color:#f92672">import</span> webdriver
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> selenium.webdriver.common.action_chains <span style="color:#f92672">import</span> ActionChains
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> email.mime.text <span style="color:#f92672">import</span> MIMEText  <span style="color:#75715e">#纯文本，HTML</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> email.mime.image <span style="color:#f92672">import</span> MIMEImage <span style="color:#75715e">#图片</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> email.mime.multipart <span style="color:#f92672">import</span> MIMEMultipart <span style="color:#75715e">#多种组合内容</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># smtplib 用于邮件的发信动作</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> smtplib
</span></span><span style="display:flex;"><span><span style="color:#75715e"># email 用于构建邮件内容</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> email.mime.text <span style="color:#f92672">import</span> MIMEText
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 构建邮件头</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> email.header <span style="color:#f92672">import</span> Header
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> datetime
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sendMail</span>(status):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 发信方的信息：发信邮箱，QQ 邮箱授权码</span>
</span></span><span style="display:flex;"><span>    from_addr <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;xxxxx@qq.com&#39;</span>
</span></span><span style="display:flex;"><span>    password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;asdfghjkl&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 收信方邮箱</span>
</span></span><span style="display:flex;"><span>    to_addr <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;yyyyy@qq.com&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 发信服务器</span>
</span></span><span style="display:flex;"><span>    smtp_server <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;smtp.qq.com&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 邮箱正文内容，第一个参数为内容，第二个参数为格式(plain 为纯文本)，第三个参数为编码</span>
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> MIMEText(<span style="color:#e6db74">&#39;恭喜你今天的打卡完成啦！&#39;</span>, <span style="color:#e6db74">&#39;plain&#39;</span>, <span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 邮件头信息</span>
</span></span><span style="display:flex;"><span>    msg[<span style="color:#e6db74">&#39;From&#39;</span>] <span style="color:#f92672">=</span> Header(<span style="color:#e6db74">&#39;打卡小助手&#39;</span>)  <span style="color:#75715e"># 发送者</span>
</span></span><span style="display:flex;"><span>    msg[<span style="color:#e6db74">&#39;To&#39;</span>] <span style="color:#f92672">=</span> Header(<span style="color:#e6db74">&#39;洛七&#39;</span>)  <span style="color:#75715e"># 接收者</span>
</span></span><span style="display:flex;"><span>    subject <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;【健康打卡】&#39;</span><span style="color:#f92672">+</span>status
</span></span><span style="display:flex;"><span>    msg[<span style="color:#e6db74">&#39;Subject&#39;</span>] <span style="color:#f92672">=</span> Header(subject, <span style="color:#e6db74">&#39;utf-8&#39;</span>)  <span style="color:#75715e"># 邮件主题</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        smtpobj <span style="color:#f92672">=</span> smtplib<span style="color:#f92672">.</span>SMTP_SSL(smtp_server)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 建立连接--qq邮箱服务和端口号（可百度查询）</span>
</span></span><span style="display:flex;"><span>        smtpobj<span style="color:#f92672">.</span>connect(smtp_server, <span style="color:#ae81ff">465</span>)    
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 登录--发送者账号和口令</span>
</span></span><span style="display:flex;"><span>        smtpobj<span style="color:#f92672">.</span>login(from_addr, password)   
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 发送邮件</span>
</span></span><span style="display:flex;"><span>        smtpobj<span style="color:#f92672">.</span>sendmail(from_addr, to_addr, msg<span style="color:#f92672">.</span>as_string()) 
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;邮件发送成功&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> smtplib<span style="color:#f92672">.</span>SMTPException:
</span></span><span style="display:flex;"><span>        print()
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;无法发送邮件&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">finally</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 关闭服务器</span>
</span></span><span style="display:flex;"><span>        smtpobj<span style="color:#f92672">.</span>quit()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check</span>(username,password):
</span></span><span style="display:flex;"><span>    browser <span style="color:#f92672">=</span> webdriver<span style="color:#f92672">.</span>Firefox(executable_path <span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;D:\geckodriver&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://xmuxg.xmu.edu.cn/app/214&#34;</span>
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>maximize_window()
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    btns <span style="color:#f92672">=</span> browser<span style="color:#f92672">.</span>find_elements_by_css_selector(<span style="color:#e6db74">&#34; div.loginTab &gt; div.buttonBox &gt; button&#34;</span>)
</span></span><span style="display:flex;"><span>    btns[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>click()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># username</span>
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>find_element_by_css_selector(<span style="color:#e6db74">&#34;input#username&#34;</span>)<span style="color:#f92672">.</span>send_keys(username)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># password</span>
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>find_element_by_css_selector(<span style="color:#e6db74">&#34;input#password&#34;</span>)<span style="color:#f92672">.</span>send_keys(password)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 登录</span>
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>find_element_by_css_selector(<span style="color:#e6db74">&#34;button.auth_login_btn[type=&#39;submit&#39;]&#34;</span>)<span style="color:#f92672">.</span>click()
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url)
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>find_element_by_css_selector(<span style="color:#e6db74">&#34;div.tab[title=&#39;我的表单&#39;]&#34;</span>)<span style="color:#f92672">.</span>click()
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 移动页面！</span>
</span></span><span style="display:flex;"><span>    js_dowmpage <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;document.querySelector(&#34;.preview-container &gt; div &gt; div &gt; div.preview-page &gt; #pdfDomContent&#34;).scrollTop = 10000 &#39;</span>
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>execute_script(js_dowmpage)
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    selectedOption <span style="color:#f92672">=</span> browser<span style="color:#f92672">.</span>find_elements_by_css_selector(<span style="color:#e6db74">&#34;.v-select.btn-block.info-value.btn-group&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>    selectedOption<span style="color:#f92672">.</span>click()
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    yes <span style="color:#f92672">=</span> browser<span style="color:#f92672">.</span>find_element_by_css_selector(<span style="color:#e6db74">&#34;.gm-scroll-view &gt; li.dropdown-items&#34;</span>)
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    yes<span style="color:#f92672">.</span>click()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 保存</span>
</span></span><span style="display:flex;"><span>    savebtn <span style="color:#f92672">=</span> browser<span style="color:#f92672">.</span>find_element_by_css_selector(<span style="color:#e6db74">&#34;.form-save.position-absolute&#34;</span>)
</span></span><span style="display:flex;"><span>    savebtn<span style="color:#f92672">.</span>click()
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 确定保存</span>
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>switch_to<span style="color:#f92672">.</span>alert<span style="color:#f92672">.</span>accept()
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>refresh()
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    browser<span style="color:#f92672">.</span>find_element_by_css_selector(<span style="color:#e6db74">&#34;div.tab[title=&#39;我的表单&#39;]&#34;</span>)<span style="color:#f92672">.</span>click()
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 获取现在保存时间</span>
</span></span><span style="display:flex;"><span>    timeI <span style="color:#f92672">=</span> browser<span style="color:#f92672">.</span>find_elements_by_css_selector(<span style="color:#e6db74">&#34;div.v-datepicker &gt; .form-control &gt; .btn-content&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    print(timeI<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>    modify <span style="color:#f92672">=</span> timeI<span style="color:#f92672">.</span>text<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 获取今天时间</span>
</span></span><span style="display:flex;"><span>    today <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%Y-%m-</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span>,time<span style="color:#f92672">.</span>localtime(time<span style="color:#f92672">.</span>time()))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> modify <span style="color:#f92672">==</span> today:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;今日签到成功&#34;</span>)
</span></span><span style="display:flex;"><span>        sendMail(<span style="color:#e6db74">&#34;签到成功&#34;</span>)
</span></span><span style="display:flex;"><span>        browser<span style="color:#f92672">.</span>quit()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;签到失败&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>users <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;学号&#34;</span>:<span style="color:#e6db74">&#34;统一认证密码&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    print(time<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#34;%H:%M&#34;</span>,time<span style="color:#f92672">.</span>localtime()))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> time<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#34;%H:%M&#34;</span>,time<span style="color:#f92672">.</span>localtime()) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;09:05&#34;</span>:
</span></span><span style="display:flex;"><span>        usernames <span style="color:#f92672">=</span> list(users<span style="color:#f92672">.</span>keys())
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> username <span style="color:#f92672">in</span> usernames:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                check(username,users[username])
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>                sendMail(<span style="color:#e6db74">&#34;签到失败&#34;</span>)
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#34;签到失败&#34;</span>)
</span></span><span style="display:flex;"><span>            time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">30</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">30</span>)
</span></span></code></pre></div><p>最后就是挂在实验室电脑上，每天自动启动</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
