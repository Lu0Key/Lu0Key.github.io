<!doctype html>
<html lang="en-us">

<head>
    
    <title>Python Flask 入门 // 洛七的摸鱼池塘</title>
    <link rel="shortcut icon" href="%20/favicon.ico%20" />
    <meta charset="utf-8" /> <meta name="generator" content="Hugo 0.80.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="洛七" />
    <meta name="description" content="" /> <link rel="stylesheet" href="https://Lu0key.github.io/css/main.min.88e7083eff65effb7485b6e6f38d10afbec25093a6fac42d734ce9024d3defbd.css" />  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python Flask 入门"/>
<meta name="twitter:description" content="Flask  Flask  特点 list  example   tuple(元组)  “可变的” tuple  tips     循环  range() continue  example   break   dict set  常用函数   定义函数  tips 空函数 参数检查 多个返回值 默认参数  坑   可变参数 关键字参数 命名关键词参数   参数组合还没看&hellip;..  递归函数  tips   尾递归 切片 Slice 切片   Iteration 迭代  如何判断一个对象是否可迭代 如何同时迭代索引和元素   列表生成式 generator 生成器 迭代器 高阶函数 map/reduce filter sorted 返回函数 闭包(Closure) 匿名函数lambda 装饰器(Decorator) 偏函数 Partial function 模块 Module  作用域 安装第三方库   OOP 访问限制 继承和多态 获取对象信息 实例属性和类属性 使用__slots__ 使用@property 多重继承 定制类  __iter__ __getattr__ __call__   枚举类 待解决问题    特点 123"/>
 <meta property="og:title" content="Python Flask 入门" />
<meta property="og:description" content="Flask  Flask  特点 list  example   tuple(元组)  “可变的” tuple  tips     循环  range() continue  example   break   dict set  常用函数   定义函数  tips 空函数 参数检查 多个返回值 默认参数  坑   可变参数 关键字参数 命名关键词参数   参数组合还没看&hellip;..  递归函数  tips   尾递归 切片 Slice 切片   Iteration 迭代  如何判断一个对象是否可迭代 如何同时迭代索引和元素   列表生成式 generator 生成器 迭代器 高阶函数 map/reduce filter sorted 返回函数 闭包(Closure) 匿名函数lambda 装饰器(Decorator) 偏函数 Partial function 模块 Module  作用域 安装第三方库   OOP 访问限制 继承和多态 获取对象信息 实例属性和类属性 使用__slots__ 使用@property 多重继承 定制类  __iter__ __getattr__ __call__   枚举类 待解决问题    特点 123" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://Lu0key.github.io/post/python-flask-%E5%85%A5%E9%97%A8/" />
<meta property="article:published_time" content="2021-01-22T16:01:50+08:00" />
<meta property="article:modified_time" content="2021-01-22T16:01:50+08:00" />


</head>

<body>
    <header class="app-header">
        <a href="https://Lu0key.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="洛七" /></a>
        <h1>洛七的摸鱼池塘</h1>
        <nav class="app-header-menu">
            <a class="app-header-menu-item" href="/tags/">Tags</a>
        </nav>
        <p>即将没书读的咸鱼</p>
        <div class="app-header-social">
            
        </div>
    </header>
    <main class="app-container">
        
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Python Flask 入门</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jan 22, 2021
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          18 min read
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line>
</svg>
              <a class="tag" href="https://Lu0key.github.io/tags/python/">python</a>
              <a class="tag" href="https://Lu0key.github.io/tags/flask/">flask</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="flask">Flask</h1>
<ul>
<li><a href="#flask">Flask</a>
<ul>
<li><a href="#%E7%89%B9%E7%82%B9">特点</a></li>
<li><a href="#list">list</a>
<ul>
<li><a href="#example">example</a></li>
</ul>
</li>
<li><a href="#tuple%E5%85%83%E7%BB%84">tuple(元组)</a>
<ul>
<li><a href="#%E5%8F%AF%E5%8F%98%E7%9A%84-tuple">“可变的” tuple</a>
<ul>
<li><a href="#tips">tips</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%BE%AA%E7%8E%AF">循环</a>
<ul>
<li><a href="#range">range()</a></li>
<li><a href="#continue">continue</a>
<ul>
<li><a href="#example-1">example</a></li>
</ul>
</li>
<li><a href="#break">break</a></li>
</ul>
</li>
<li><a href="#dict">dict</a></li>
<li><a href="#set">set</a>
<ul>
<li><a href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0">常用函数</a></li>
</ul>
</li>
<li><a href="#%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0">定义函数</a>
<ul>
<li><a href="#tips-1">tips</a></li>
<li><a href="#%E7%A9%BA%E5%87%BD%E6%95%B0">空函数</a></li>
<li><a href="#%E5%8F%82%E6%95%B0%E6%A3%80%E6%9F%A5">参数检查</a></li>
<li><a href="#%E5%A4%9A%E4%B8%AA%E8%BF%94%E5%9B%9E%E5%80%BC">多个返回值</a></li>
<li><a href="#%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0">默认参数</a>
<ul>
<li><a href="#%E5%9D%91">坑</a></li>
</ul>
</li>
<li><a href="#%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0">可变参数</a></li>
<li><a href="#%E5%85%B3%E9%94%AE%E5%AD%97%E5%8F%82%E6%95%B0">关键字参数</a></li>
<li><a href="#%E5%91%BD%E5%90%8D%E5%85%B3%E9%94%AE%E8%AF%8D%E5%8F%82%E6%95%B0">命名关键词参数</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E6%95%B0%E7%BB%84%E5%90%88%E8%BF%98%E6%B2%A1%E7%9C%8B">参数组合还没看&hellip;..</a>
<ul>
<li><a href="#%E9%80%92%E5%BD%92%E5%87%BD%E6%95%B0">递归函数</a>
<ul>
<li><a href="#tips-2">tips</a></li>
</ul>
</li>
<li><a href="#%E5%B0%BE%E9%80%92%E5%BD%92">尾递归</a></li>
<li><a href="#%E5%88%87%E7%89%87">切片</a></li>
<li><a href="#slice-%E5%88%87%E7%89%87">Slice 切片</a></li>
</ul>
</li>
<li><a href="#iteration-%E8%BF%AD%E4%BB%A3">Iteration 迭代</a>
<ul>
<li><a href="#%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%90%A6%E5%8F%AF%E8%BF%AD%E4%BB%A3">如何判断一个对象是否可迭代</a></li>
<li><a href="#%E5%A6%82%E4%BD%95%E5%90%8C%E6%97%B6%E8%BF%AD%E4%BB%A3%E7%B4%A2%E5%BC%95%E5%92%8C%E5%85%83%E7%B4%A0">如何同时迭代索引和元素</a></li>
</ul>
</li>
<li><a href="#%E5%88%97%E8%A1%A8%E7%94%9F%E6%88%90%E5%BC%8F">列表生成式</a></li>
<li><a href="#generator-%E7%94%9F%E6%88%90%E5%99%A8">generator 生成器</a></li>
<li><a href="#%E8%BF%AD%E4%BB%A3%E5%99%A8">迭代器</a></li>
<li><a href="#%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0">高阶函数</a></li>
<li><a href="#mapreduce">map/reduce</a></li>
<li><a href="#filter">filter</a></li>
<li><a href="#sorted">sorted</a></li>
<li><a href="#%E8%BF%94%E5%9B%9E%E5%87%BD%E6%95%B0">返回函数</a></li>
<li><a href="#%E9%97%AD%E5%8C%85closure">闭包(Closure)</a></li>
<li><a href="#%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0lambda">匿名函数lambda</a></li>
<li><a href="#%E8%A3%85%E9%A5%B0%E5%99%A8decorator">装饰器(Decorator)</a></li>
<li><a href="#%E5%81%8F%E5%87%BD%E6%95%B0-partial-function">偏函数 Partial function</a></li>
<li><a href="#%E6%A8%A1%E5%9D%97-module">模块 Module</a>
<ul>
<li><a href="#%E4%BD%9C%E7%94%A8%E5%9F%9F">作用域</a></li>
<li><a href="#%E5%AE%89%E8%A3%85%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93">安装第三方库</a></li>
</ul>
</li>
<li><a href="#oop">OOP</a></li>
<li><a href="#%E8%AE%BF%E9%97%AE%E9%99%90%E5%88%B6">访问限制</a></li>
<li><a href="#%E7%BB%A7%E6%89%BF%E5%92%8C%E5%A4%9A%E6%80%81">继承和多态</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1%E4%BF%A1%E6%81%AF">获取对象信息</a></li>
<li><a href="#%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7%E5%92%8C%E7%B1%BB%E5%B1%9E%E6%80%A7">实例属性和类属性</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8__slots__">使用<code>__slots__</code></a></li>
<li><a href="#%E4%BD%BF%E7%94%A8property">使用@property</a></li>
<li><a href="#%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF">多重继承</a></li>
<li><a href="#%E5%AE%9A%E5%88%B6%E7%B1%BB">定制类</a>
<ul>
<li><a href="#__iter__"><code>__iter__</code></a></li>
<li><a href="#__getattr__"><code>__getattr__</code></a></li>
<li><a href="#__call__"><code>__call__</code></a></li>
</ul>
</li>
<li><a href="#%E6%9E%9A%E4%B8%BE%E7%B1%BB">枚举类</a></li>
<li><a href="#%E5%BE%85%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98">待解决问题</a></li>
</ul>
</li>
</ul>
<h2 id="特点">特点</h2>
<p>123<br>
3<br>
123%10=3<br>
整数<br>
123//100=1<br>
&lsquo;123&rsquo;+&lsquo;123&rsquo;=&lsquo;123123&rsquo; str<br>
123+123=246 int<br>
123//10=12<br>
12%10=2<br>
12//10=1<br>
range(10)
0-9</p>
<p>轻量级的框架 Micro Framework
<a href="https://blog.igevin.info/posts/flask-startup-guideline/">https://blog.igevin.info/posts/flask-startup-guideline/</a></p>
<p>python 的字符串格式化</p>
<blockquote>
<p><a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1017075323632896">https://www.liaoxuefeng.com/wiki/1016959663602400/1017075323632896</a></p>
</blockquote>
<h2 id="list">list</h2>
<p>list 是有序集合</p>
<ul>
<li>len() 获取 list 的元素个数</li>
<li>append() 追加元素到末尾</li>
<li>insert() 将元素插入到指定地方</li>
<li>pop() 删除末尾的元素</li>
<li>可以直接赋值改某个元素的值</li>
<li>元素的数据类型可以不同</li>
<li>list 的元素可以是 list</li>
</ul>
<h3 id="example">example</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">classmates <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#e6db74">&#39;Bob&#39;</span>,<span style="color:#e6db74">&#39;John&#39;</span>] <span style="color:#75715e"># index</span>
len(classmates) <span style="color:#75715e">#3</span>
classmates[<span style="color:#ae81ff">0</span>] <span style="color:#75715e">#&#39;Luokey&#39;</span>
classmates[<span style="color:#ae81ff">3</span>] <span style="color:#75715e">#list index out of range</span>

<span style="color:#75715e">#负的就是倒数第几个</span>
classmates[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#75715e">#&#39;John&#39;</span>
classmates[<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>] <span style="color:#75715e">#&#39;Luokey&#39;</span>
classmates[<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>] <span style="color:#75715e">#list index out of range</span>

<span style="color:#75715e">#向末尾增加元素</span>
classmates<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;Helen&#39;</span>)
<span style="color:#75715e">#classmates = [&#39;Luokey&#39;,&#39;Bob&#39;,&#39;John&#39;,&#39;Helen&#39;]</span>

<span style="color:#75715e">#插入到某指定位置</span>
classmates <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#e6db74">&#39;Bob&#39;</span>,<span style="color:#e6db74">&#39;John&#39;</span>]
classmates<span style="color:#f92672">.</span>insert(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;Linda&#39;</span>)
<span style="color:#75715e">#classmates = [&#39;Luokey&#39;,&#39;Linda&#39;,&#39;Bob&#39;,&#39;John&#39;]</span>

<span style="color:#75715e">#删除末尾的元素</span>
classmates <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#e6db74">&#39;Bob&#39;</span>,<span style="color:#e6db74">&#39;John&#39;</span>]
classmates<span style="color:#f92672">.</span>pop()
<span style="color:#75715e">#classmates = [&#39;Luokey&#39;,&#39;Bob&#39;]</span>
<span style="color:#75715e">#删掉指定位置的元素</span>
classmates <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#e6db74">&#39;Bob&#39;</span>,<span style="color:#e6db74">&#39;John&#39;</span>]
classmates<span style="color:#f92672">.</span>pop(<span style="color:#ae81ff">1</span>) <span style="color:#75715e">#根据索引删</span>
<span style="color:#75715e">#classmates = [&#39;Luokey&#39;，&#39;John&#39;]</span>

<span style="color:#75715e">#直接赋值改元素</span>
classmates[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;hhhh&#39;</span>
<span style="color:#75715e">#classmates = [&#39;Luokey&#39;,&#39;hhhh&#39;,&#39;John&#39;]</span>
classmates[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span> <span style="color:#75715e">#类型可以不同</span>
<span style="color:#75715e">#classmates = [&#39;Luokey&#39;,3,&#39;John&#39;]</span>
classmates[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>]
<span style="color:#75715e">#classmates = [&#39;Luokey&#39;,[1,2,3],&#39;John&#39;]</span>

classmates <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Luokey&#39;</span>,[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>],<span style="color:#e6db74">&#39;John&#39;</span>]
classmates[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#75715e">#3 相当于二维数组</span>

L <span style="color:#f92672">=</span> []
len(L) <span style="color:#75715e">#0</span>

</code></pre></div><h2 id="tuple元组">tuple(元组)</h2>
<p>tuple 有序,且初始化后不能修改<br>
因为不可修改所以更加安全</p>
<ul>
<li>不可修改</li>
<li>安全</li>
<li>定义时直接确定元素</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#定义一个空 tuple</span>
t <span style="color:#f92672">=</span> ()

<span style="color:#75715e">#定义一个二元素 tuple</span>
t <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>)

<span style="color:#75715e">#定于一元素的 tuple有坑</span>
t <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>,) <span style="color:#75715e"># 正常的一元素 tuple</span>
t <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># 括号可以表示数学公式中的小括号，有歧义</span>
</code></pre></div><h3 id="可变的-tuple">“可变的” tuple</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">t <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;a&#39;</span>,<span style="color:#e6db74">&#39;b&#39;</span>,[<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>]) 
t[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;X&#39;</span>
t[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Y&#39;</span>
<span style="color:#75715e"># t = (&#39;a&#39;,&#39;b&#39;,[&#39;X&#39;,&#39;Y&#39;]) </span>
</code></pre></div><p>tuple 的内容却是变了，不变的是tuple 指向的是 list ，list 还是那个 list，只是 list 里的元素变了</p>
<h4 id="tips">tips</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> input()
<span style="color:#75715e"># a是str</span>
<span style="color:#75715e"># 如果希望得到的是int</span>
b <span style="color:#f92672">=</span> int(a) <span style="color:#75715e">#前提是a可以是数字</span>
</code></pre></div><h2 id="循环">循环</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#75715e"># for x in ...</span>
<span style="color:#75715e"># 把每个元素带入 x 然后执行语句</span>

<span style="color:#75715e"># 高斯心算题 1 + 2 + cdots + 100 </span>
sum <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> 
<span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">101</span>): <span style="color:#75715e">#要记得这边有冒号啊！</span>
    sum <span style="color:#f92672">+=</span> x
<span style="color:#75715e"># sum 5050</span>

names <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#e6db74">&#39;Bob&#39;</span>,<span style="color:#e6db74">&#39;Helen&#39;</span>]
<span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> names:
    <span style="color:#66d9ef">print</span>(x)
<span style="color:#75715e"># 输出的结果：</span>
<span style="color:#75715e"># Luokey</span>
<span style="color:#75715e"># Bob</span>
<span style="color:#75715e"># Helen</span>
</code></pre></div><h3 id="range">range()</h3>
<p><code>range(5)</code> 可以生成0-4的整数序列</p>
<h3 id="continue">continue</h3>
<p>结束这次循环，进入下次循环</p>
<h4 id="example-1">example</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 输出奇数</span>
n <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> 
<span style="color:#66d9ef">while</span> n <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">10</span>: <span style="color:#75715e"># 记得要写冒号！！！</span>
    <span style="color:#75715e"># python 没有 n++ 这种写法</span>
    n <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">if</span> n<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>: <span style="color:#75715e"># 记得要写冒号！！！</span>
        <span style="color:#66d9ef">continue</span>
    <span style="color:#66d9ef">print</span>(n)
</code></pre></div><h3 id="break">break</h3>
<p><code>break</code> 是直接结束循环</p>
<h2 id="dict">dict</h2>
<p>字典，全称：dictionary 在其他语言叫 map ,使用 键-值(key-value)储存</p>
<ul>
<li>查找速度快</li>
<li>在放进去的时候，必须根据key算出value的存放位置</li>
<li>一个key只能对应一个value</li>
<li>占用内存大，浪费内存多</li>
<li>无序</li>
<li>空间换时间</li>
<li>key 不可变</li>
<li>get()</li>
<li>pop(key)</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">d <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;Luokey&#39;</span> : <span style="color:#ae81ff">95</span>,<span style="color:#e6db74">&#39;Bob&#39;</span> : <span style="color:#ae81ff">60</span>}
d[<span style="color:#e6db74">&#39;Luokey&#39;</span>] <span style="color:#75715e"># 95</span>
d[<span style="color:#e6db74">&#39;Luokey&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span> <span style="color:#75715e"># 覆盖</span>

d[<span style="color:#e6db74">&#39;Helen&#39;</span>] <span style="color:#75715e"># 不存在，报错</span>
<span style="color:#e6db74">&#39;Helen&#39;</span> <span style="color:#f92672">in</span> d <span style="color:#75715e"># False</span>
d<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;Helen&#39;</span>) <span style="color:#75715e"># None</span>
d<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;Helen&#39;</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#75715e">#相当于有了就覆盖，没有就创造并赋值,</span>
<span style="color:#75715e"># 试了下，错了回去问问</span>
d[<span style="color:#e6db74">&#39;Helen&#39;</span>] <span style="color:#75715e"># -1</span>

<span style="color:#75715e"># pop</span>
d <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;Luokey&#39;</span> : <span style="color:#ae81ff">95</span>,<span style="color:#e6db74">&#39;Bob&#39;</span> : <span style="color:#ae81ff">60</span>}
d<span style="color:#f92672">.</span>pop(<span style="color:#e6db74">&#39;Luokey&#39;</span>) <span style="color:#75715e"># 返回该key的value，并删除此key</span>
</code></pre></div><h2 id="set">set</h2>
<ul>
<li>key 的集合，不储存 value</li>
<li>无序</li>
<li>不重复</li>
<li>可理解为高中的集合</li>
<li>交集</li>
<li>并集</li>
<li>add(key)</li>
<li>remove(key)</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 创建一个 set</span>
s <span style="color:#f92672">=</span> set([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>])
s <span style="color:#75715e"># {1,2,3}，显示的顺序不表示set有序</span>

s<span style="color:#f92672">.</span>add(<span style="color:#ae81ff">4</span>) <span style="color:#75715e"># {1,2,3,4}</span>
s<span style="color:#f92672">.</span>add(<span style="color:#ae81ff">4</span>) <span style="color:#75715e"># {1,2,3,4}重复添加无效果</span>

s1 <span style="color:#f92672">=</span> set([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>])
s1 <span style="color:#75715e"># {1,2,3,4} 自动过滤重复的</span>

<span style="color:#75715e"># 交集</span>
s1 <span style="color:#f92672">=</span> set{[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>]}
s2 <span style="color:#f92672">=</span> set{[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>]}
s1 <span style="color:#f92672">&amp;</span> s2 <span style="color:#75715e"># {2,3}</span>
s1 <span style="color:#f92672">|</span> s2 <span style="color:#75715e"># {1,2,3,4}</span>
</code></pre></div><h3 id="常用函数">常用函数</h3>
<ul>
<li>abs()</li>
<li>max()</li>
<li>查看函数作用的help()
<ul>
<li>例：help(abs)</li>
</ul>
</li>
<li>int()</li>
<li>hex() # 转成16进制</li>
</ul>
<h2 id="定义函数">定义函数</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_abs</span>(x): <span style="color:#75715e"># 记得写冒号！！！</span>
    <span style="color:#66d9ef">if</span> x <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>: <span style="color:#75715e"># 记得写冒号！！！</span>
        <span style="color:#66d9ef">return</span> x
    <span style="color:#66d9ef">else</span>: <span style="color:#75715e"># 记得写冒号！！！</span>
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>x
</code></pre></div><p>max</p>
<h4 id="tips-1">tips</h4>
<p>如果没有<code>return</code>语句，函数执行完毕也返回结果，只是结果为<code>None</code><br>
<code>return None</code>可写成<code>return</code></p>
<h3 id="空函数">空函数</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 定义一个什么时也不做的空函数</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">nop</span>():
    <span style="color:#66d9ef">pass</span>
</code></pre></div><p><code>pass</code>可以作为占位符，如果现在没有想好怎么写函数的代码，可以先放一个<code>pass</code>，让代码运行起来</p>
<ul>
<li>缺少了<code>pass</code>会有语法错误</li>
</ul>
<h3 id="参数检查">参数检查</h3>
<ul>
<li>参数类型
<ul>
<li>类型有误不会帮忙检查</li>
</ul>
</li>
<li>参数个数
<ul>
<li>有问题会返回<code>TypeError</code>，会自动检查</li>
</ul>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_abs</span>(x): <span style="color:#75715e"># 记得写冒号！！！</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isinstance(x,(int, float)):
        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">TypeError</span>(<span style="color:#e6db74">&#39;bad operand type&#39;</span>)
    <span style="color:#66d9ef">if</span> x <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>: <span style="color:#75715e"># 记得写冒号！！！</span>
        <span style="color:#66d9ef">return</span> x
    <span style="color:#66d9ef">else</span>: <span style="color:#75715e"># 记得写冒号！！！</span>
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>x
</code></pre></div><p><code>isinstance()</code>是一个内置的数据类型检查函数</p>
<h3 id="多个返回值">多个返回值</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">move</span>(x,y,z):
    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">*</span>z, y<span style="color:#f92672">*</span>z

r <span style="color:#f92672">=</span> move(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>)
<span style="color:#66d9ef">print</span>(r)
<span style="color:#f92672">&gt;&gt;&gt;</span> (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">6</span>)
<span style="color:#75715e"># 返回值实际上是一个tuple</span>
</code></pre></div><h3 id="默认参数">默认参数</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">power</span>(x,city<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;shangdong&#39;</span>,age<span style="color:#f92672">=</span><span style="color:#ae81ff">19</span>,gender<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;man&#39;</span>):
    s <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">while</span> n <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
        s <span style="color:#f92672">=</span> s<span style="color:#f92672">*</span>x
        n <span style="color:#f92672">-=</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> s

<span style="color:#75715e"># power(5) 等价于 power(5,2)</span>
<span style="color:#75715e"># 参数按顺序填入</span>
</code></pre></div><ul>
<li>必填参数在前，默认参数在后</li>
<li>变化大的参数放前，变化小的放后，可设置为默认参数</li>
<li>当有多个默认参数时,前面有默认参数为默认状态时，要加参数名</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 前面有默认参数为默认状态时</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">enroll</span>(name, gender, gender<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, city<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Shandong&#39;</span>):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;name:&#39;</span>,name)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;gender:&#39;</span>,gender)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;age&#39;</span>,age)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;city:&#39;</span>city)

enroll(<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#ae81ff">17</span>) <span style="color:#75715e"># 此时默认Luokey在龙岩，年纪改为17</span>
enroll(<span style="color:#e6db74">&#39;Bob&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>,city<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Beijing&#39;</span>) <span style="color:#75715e"># 此时默认Bob是6岁，城市改为Beijing</span>
<span style="color:#75715e"># 前面有默认参数为默认状态时</span>
</code></pre></div><h4 id="坑">坑</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_end</span>(L<span style="color:#f92672">=</span>[]):
    L<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;end&#39;</span>)
    <span style="color:#66d9ef">return</span> L
<span style="color:#66d9ef">print</span>(add_end())
<span style="color:#66d9ef">print</span>(add_end())
<span style="color:#66d9ef">print</span>(add_end())
<span style="color:#f92672">&gt;&gt;&gt;</span>
[<span style="color:#e6db74">&#39;end&#39;</span>]
[<span style="color:#e6db74">&#39;end&#39;</span>, <span style="color:#e6db74">&#39;end&#39;</span>]
[<span style="color:#e6db74">&#39;end&#39;</span>, <span style="color:#e6db74">&#39;end&#39;</span>, <span style="color:#e6db74">&#39;end&#39;</span>]
</code></pre></div><p>Python 函数在定义的时候，默认参数<code>L</code>的值就被计算出来了，因此默认参数<code>L</code>也是一个变量，他指向对象<code>[]</code>，每次调用该函数，如果改变了<code>L</code>的内容，下次调用时，默认参数的内容就改变了，不再是定义时的<code>[]</code></p>
<blockquote>
<p>定义默认参数时，默认参数必须指向不变对象</p>
</blockquote>
<p>修改后的代码：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_end</span>(L<span style="color:#f92672">=</span>None):
    <span style="color:#66d9ef">if</span> L <span style="color:#f92672">is</span> None:
        L <span style="color:#f92672">=</span> []
    L<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;end&#39;</span>)
    <span style="color:#66d9ef">return</span> L
<span style="color:#75715e"># 这样每次得到的都是 [&#39;end&#39;]</span>
</code></pre></div><h3 id="可变参数">可变参数</h3>
<p>可变参数就是说，传入的参数个数是可变的 (可以是0)</p>
<ul>
<li>把参数作为一个 list 或 tuple 传进来</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 计算一组数的和</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc</span>(numbers):
    sum <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> numbers:
        sum <span style="color:#f92672">+=</span> x
    <span style="color:#66d9ef">return</span> sum

<span style="color:#75715e"># 调用时要先组装出一个list 或tuple </span>
calc([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>]) <span style="color:#75715e"># 6</span>
calc((<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>)) <span style="color:#75715e"># 6</span>
</code></pre></div><p>定义可变参数，只需要在参数前面加一个<code>*</code>,在函数内部，参数接收到的是一个tuple</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc</span>(<span style="color:#f92672">*</span>numbers):
    sum <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> numbers: <span style="color:#75715e"># 这里的numbers 已经是tuple了</span>
        sum <span style="color:#f92672">+=</span> x
    <span style="color:#66d9ef">return</span> sum
calc(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">54</span>,<span style="color:#ae81ff">5</span>) <span style="color:#75715e"># 69</span>

<span style="color:#75715e"># 在 list 前面加一个 * 可以把 list 的所有元素当可变参数传进函数</span>
nums <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>]
calc(<span style="color:#f92672">*</span>nums) <span style="color:#75715e"># 15，这里加 * </span>
</code></pre></div><h3 id="关键字参数">关键字参数</h3>
<p>关键字参数允许你传入任意个含参数名的参数 (包括0个) ,这些关键字参数在函数内部自动组装成一个dict</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">person</span>(name, age, <span style="color:#f92672">*</span>kw):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;name:&#39;</span>,name,<span style="color:#e6db74">&#39;age:&#39;</span>,age,<span style="color:#e6db74">&#39;other&#39;</span>:kw)
    <span style="color:#66d9ef">return</span>
<span style="color:#75715e"># kw 就变成一个一个dict</span>

person(<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#ae81ff">19</span>) 
<span style="color:#75715e"># name: Luokey age: 19 other {}</span>

person(<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#ae81ff">19</span>,city<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Longyan&#39;</span>) 
<span style="color:#75715e"># name: Luokey age: 19 other {&#39;city&#39;: &#39;Longyan&#39;}</span>

person(<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#ae81ff">19</span>,city<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Longyan&#39;</span>,job<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;student&#39;</span>)
<span style="color:#75715e"># name: Luokey age: 19 other {&#39;city&#39;: &#39;Longyan&#39;, &#39;job&#39;: &#39;student&#39;}</span>
</code></pre></div><p><code>**extra</code>表示把<code>extra</code>这个dict的所有key-value用关键词参数传入到函数的<code>**kw</code>参数，<code>kw</code>获得的dict时<code>extra</code>的一个拷贝，对<code>kw</code>的改动不会影响函数外的<code>extra</code></p>
<h3 id="命名关键词参数">命名关键词参数</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 检查是否有 city 和 job 参数</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">person</span>(name, age, <span style="color:#f92672">**</span>kw):
    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;city&#39;</span> <span style="color:#f92672">in</span> kw:
        <span style="color:#66d9ef">pass</span>
    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;job&#39;</span> <span style="color:#f92672">in</span> kw:
        <span style="color:#66d9ef">pass</span>
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;name:&#39;</span>name,<span style="color:#e6db74">&#39;,age:&#39;</span>age,<span style="color:#e6db74">&#39;,other:&#39;</span>kw)
</code></pre></div><p>限制关键字参数的名字，可以用命名关键字</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 只接收 city 和 job 作为关键字参数</span>
<span style="color:#75715e"># 用 * 作为特殊分隔符</span>
<span style="color:#75715e"># 如果没有分隔符，会被识别为位置参数</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">person</span>(name, age, <span style="color:#f92672">*</span>, city, job):
    <span style="color:#66d9ef">print</span>(name,age,city,job)
    <span style="color:#66d9ef">return</span>

<span style="color:#75715e"># 命名参数必须传入参数名</span>
<span style="color:#75715e"># 不传入参数名会报错</span>
person(<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#ae81ff">19</span>,city<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Longyan&#39;</span>,job<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;student&#39;</span>)

<span style="color:#75715e"># 命名参数可以不按顺序传入</span>
person(<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#ae81ff">19</span>,job<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;student&#39;</span>,city<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Longyan&#39;</span>)

<span style="color:#75715e"># 明明关键字可以有默认值，从而简化调用</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">person</span>(name, age, <span style="color:#f92672">*</span>, city<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Longyan&#39;</span>, job):
    <span style="color:#66d9ef">print</span>(name,age,city,job)
    <span style="color:#66d9ef">return</span>

<span style="color:#75715e"># 由于命名关键字有默认值，调用时可不传入city参数</span>
person(<span style="color:#e6db74">&#39;Luokey&#39;</span>,<span style="color:#ae81ff">19</span>,job<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;student&#39;</span>)

<span style="color:#75715e"># 如果函数定义中已经有了一个可变参数</span>
<span style="color:#75715e"># 后面跟着的命名关键字参数就不需要一个特殊分隔符了</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">person</span>(name, age, <span style="color:#f92672">*</span>arg, city, job):
    <span style="color:#66d9ef">print</span>(name,age,arg,city,job)
    <span style="color:#66d9ef">return</span>

</code></pre></div><h2 id="参数组合还没看">参数组合还没看&hellip;..</h2>
<h3 id="递归函数">递归函数</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 计算阶乘</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fact</span>(n):
    <span style="color:#66d9ef">if</span> n<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> n<span style="color:#f92672">*</span>fact(n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</code></pre></div><h4 id="tips-2">tips</h4>
<blockquote>
<p>使用递归函数需要注意防止栈溢出。在计算机中，函数调用是通过栈（stack）这种数据结构实现的，每当进入一个函数调用，栈就会加一层栈帧，每当函数返回，栈就会减一层栈帧。由于栈的大小不是无限的，所以，递归调用的次数过多，会导致栈溢出。</p>
</blockquote>
<h3 id="尾递归">尾递归</h3>
<p>利用尾递归优化可以解决stack 溢出</p>
<blockquote>
<p>尾递归是指，在函数返回的时候，调用自身本身，并且，return语句不能包含表达式。这样，编译器或者解释器就可以把尾递归做优化，使递归本身无论调用多少次，都只占用一个栈帧，不会出现栈溢出的情况。</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 阶乘的尾递归优化</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fact</span>(n):
    <span style="color:#66d9ef">return</span> fact_iter(n,<span style="color:#ae81ff">1</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fact_iter</span>(num, product):
    <span style="color:#66d9ef">if</span> num <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
        <span style="color:#66d9ef">return</span> product
    <span style="color:#66d9ef">return</span> fact_iter(num<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, num<span style="color:#f92672">*</span>product)
</code></pre></div><h3 id="切片">切片</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">L <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Luokey&#39;</span>, <span style="color:#e6db74">&#39;Helen&#39;</span>, <span style="color:#e6db74">&#39;Tracy&#39;</span>, <span style="color:#e6db74">&#39;Bob&#39;</span>, <span style="color:#e6db74">&#39;Jack&#39;</span>]

<span style="color:#75715e"># 取前3个元素</span>

<span style="color:#75715e"># 用index索引</span>
[L[<span style="color:#ae81ff">0</span>],L[<span style="color:#ae81ff">1</span>],L[<span style="color:#ae81ff">2</span>]] <span style="color:#75715e"># [&#39;Luokey&#39;, &#39;Helen&#39;, &#39;Tracy&#39;]</span>

<span style="color:#75715e"># 用for循环</span>
r <span style="color:#f92672">=</span> []
n <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n)
    r<span style="color:#f92672">.</span>append(L[i])
<span style="color:#75715e"># r = [&#39;Luokey&#39;, &#39;Helen&#39;, &#39;Tracy&#39;]</span>

<span style="color:#75715e"># 切片(Slice)操作符</span>
L[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">3</span>] <span style="color:#75715e"># [&#39;Luokey&#39;, &#39;Helen&#39;, &#39;Tracy&#39;]</span>
<span style="color:#75715e"># 从索引 0 开始，直到索引 3 为止，不包括索引 3</span>

<span style="color:#75715e"># 第一个索引时 0 时可省略</span>
L[:<span style="color:#ae81ff">3</span>] <span style="color:#75715e"># [&#39;Luokey&#39;, &#39;Helen&#39;, &#39;Tracy&#39;]</span>

<span style="color:#75715e"># 倒数切片</span>
L[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>:] <span style="color:#75715e"># [&#39;Bob&#39;, &#39;Jack&#39;] 最后两个</span>
L[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#75715e"># [&#39;Bob&#39;]</span>
</code></pre></div><h3 id="slice-切片">Slice 切片</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">L <span style="color:#f92672">=</span> list(range(<span style="color:#ae81ff">100</span>))
<span style="color:#75715e"># L = [0,1,2,3,..., 99]</span>

<span style="color:#75715e"># 取前10位</span>
L[:<span style="color:#ae81ff">10</span>] <span style="color:#75715e"># [0,1,2,3,4,5,6,7,8,9]</span>

<span style="color:#75715e"># 前11-20个数</span>
L[<span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">20</span>] <span style="color:#75715e"># [10,11,12,13,14,15,16,17,18,19]</span>

<span style="color:#75715e"># 前10个数，每两个取一个</span>
L[:<span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">2</span>] <span style="color:#75715e"># [0,2,4,6,8]</span>

<span style="color:#75715e"># 所有数，每5个取一个</span>
L[::<span style="color:#ae81ff">5</span>]
<span style="color:#75715e"># [0,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95]</span>

<span style="color:#75715e"># 复制一个 list</span>
L[:] <span style="color:#75715e"># [0,1,2,3,...,99]</span>

<span style="color:#75715e"># tuple 也是一种 list </span>
<span style="color:#75715e"># tuple 也可以用 Slice 操作</span>
<span style="color:#75715e"># 切片结果还是 tuple</span>
(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">7</span>)[:<span style="color:#ae81ff">3</span>] <span style="color:#75715e"># (0,1,2)</span>


<span style="color:#75715e"># 字符串 &#39;xxx&#39; 也可一个看成是一种 list</span>
<span style="color:#75715e"># 字符串也可以进行切片操作</span>
<span style="color:#e6db74">&#39;ASDFGH&#39;</span>[:<span style="color:#ae81ff">3</span>] <span style="color:#75715e"># &#39;ASD&#39;</span>
</code></pre></div><p>用<code>slice</code>实现除去头尾空格</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">trim</span>(s):
    <span style="color:#66d9ef">if</span> len(s) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;请输入有效内容&#34;</span>)
        <span style="color:#66d9ef">return</span> s
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">if</span> s[:<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39; &#39;</span>:
            s <span style="color:#f92672">=</span> s[<span style="color:#ae81ff">1</span>:len(s)]
            s <span style="color:#f92672">=</span> trim(s)
        <span style="color:#66d9ef">elif</span> s[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39; &#39;</span>:
                s <span style="color:#f92672">=</span> s[: len(s) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]
                s <span style="color:#f92672">=</span> trim(s)
        <span style="color:#66d9ef">return</span> s
</code></pre></div><h2 id="iteration-迭代">Iteration 迭代</h2>
<p>给定一个 list 或 tuple ,我们可以通过<code>for</code>循环来遍历这个 list 或 tuple,这种遍历叫迭代 (Iteration)</p>
<p>迭代通过<code>for ... in</code>来完成</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 迭代 dict</span>
d <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;a&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;b&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;c&#39;</span>: <span style="color:#ae81ff">3</span>}
<span style="color:#66d9ef">for</span> key <span style="color:#f92672">in</span> d:
    <span style="color:#66d9ef">print</span>(key)
<span style="color:#75715e"># a</span>
<span style="color:#75715e"># b</span>
<span style="color:#75715e"># c</span>
<span style="color:#75715e"># 默认迭代的是key</span>

<span style="color:#75715e"># 迭代 value</span>
d <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;a&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;b&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;c&#39;</span>: <span style="color:#ae81ff">3</span>}
<span style="color:#66d9ef">for</span> value <span style="color:#f92672">in</span> d<span style="color:#f92672">.</span>values():
    <span style="color:#66d9ef">print</span>(value)
<span style="color:#75715e"># 1</span>
<span style="color:#75715e"># 2</span>
<span style="color:#75715e"># 3</span>

<span style="color:#75715e"># 同时迭代 key 和 value</span>
d <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;a&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;b&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;c&#39;</span>: <span style="color:#ae81ff">3</span>}
<span style="color:#66d9ef">for</span> k,v <span style="color:#f92672">in</span> d<span style="color:#f92672">.</span>items():
    <span style="color:#66d9ef">print</span>(k,v)
<span style="color:#75715e"># a 1</span>
<span style="color:#75715e"># b 2</span>
<span style="color:#75715e"># c 3</span>
</code></pre></div><h3 id="如何判断一个对象是否可迭代">如何判断一个对象是否可迭代</h3>
<p>通过<code>collections</code>模块的<code>Iterable</code>类型判断</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> Iterable
isinstance(<span style="color:#e6db74">&#39;abc&#39;</span>, Iterable) <span style="color:#75715e"># 判断 str 是否可迭代 </span>
<span style="color:#75715e"># Ture</span>
</code></pre></div><h3 id="如何同时迭代索引和元素">如何同时迭代索引和元素</h3>
<p>使用Python内置的<code>enumerate</code>函数，可以把list变成 索引-元素对</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">for</span> i, value <span style="color:#f92672">in</span> enumerate([<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>,<span style="color:#e6db74">&#39;C&#39;</span>]):
    <span style="color:#66d9ef">print</span>(i, value)
<span style="color:#75715e"># 0 A</span>
<span style="color:#75715e"># 1 B</span>
<span style="color:#75715e"># 2 C</span>

<span style="color:#75715e"># for 循环中引用两个变量</span>
<span style="color:#66d9ef">for</span> x,y <span style="color:#f92672">in</span> [(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">4</span>), (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">9</span>)]:
    <span style="color:#66d9ef">print</span>(x,y)
<span style="color:#75715e"># 1 1</span>
<span style="color:#75715e"># 2 4</span>
<span style="color:#75715e"># 3 9</span>
</code></pre></div><h2 id="列表生成式">列表生成式</h2>
<p>List Comprehensions</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 生成[1,2,3,4,5,6,7,8,9]</span>
<span style="color:#75715e"># 可以用 list(range(1,10))</span>
list(range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">9</span>)) <span style="color:#75715e"># [1,2,3,4,5,6,7,8,9]</span>

<span style="color:#75715e"># 生成 [1,4,9,16,25,36,49,64,81,100]</span>
<span style="color:#75715e"># 用 for 循环</span>
L <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">11</span>)
    L<span style="color:#f92672">.</span>append(x<span style="color:#f92672">*</span>x)
<span style="color:#75715e"># L = [1,4,9,16,25,36,49,64,81,100]</span>
<span style="color:#75715e"># 用列表生成法</span>
[x<span style="color:#f92672">*</span>x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">11</span>)]
<span style="color:#75715e"># [1,4,9,16,25,36,49,64,81,100]</span>

<span style="color:#75715e"># 筛出偶数的平方</span>
[x<span style="color:#f92672">*</span>x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">11</span>) <span style="color:#66d9ef">if</span> x<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>]
<span style="color:#75715e"># [4,16,36,64,100]</span>
</code></pre></div><p>用两层循环生成全排列</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">[m<span style="color:#f92672">+</span>n <span style="color:#66d9ef">for</span> m <span style="color:#f92672">in</span> <span style="color:#e6db74">&#39;ABC&#39;</span> <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> <span style="color:#e6db74">&#39;XYZ&#39;</span>]
<span style="color:#75715e"># [&#39;AX&#39;,&#39;AY&#39;,&#39;AZ&#39;,&#39;BX&#39;,&#39;BY&#39;,&#39;BZ&#39;,&#39;CX&#39;,&#39;CY&#39;,&#39;CZ&#39;]</span>
</code></pre></div><h2 id="generator-生成器">generator 生成器</h2>
<p>一边循环一边计算的机制，称为生成器(generator)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">L <span style="color:#f92672">=</span> [x<span style="color:#f92672">*</span>x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>)] <span style="color:#75715e"># list</span>
g <span style="color:#f92672">=</span> (x<span style="color:#f92672">*</span>x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>)) <span style="color:#75715e"># generator</span>

<span style="color:#75715e"># next()可以获得genertor的下一个返回值</span>
next(g) <span style="color:#75715e"># 0</span>
next(g) <span style="color:#75715e"># 1</span>
<span style="color:#75715e"># 当generator没有值可以抛出时</span>
<span style="color:#75715e"># 会有StopIteration错误</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 打印 fibonacci 数列</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fib</span>(max):
    n, a, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">while</span> n<span style="color:#f92672">&lt;</span> max:
        <span style="color:#66d9ef">print</span>(b)
        a, b <span style="color:#f92672">=</span> b, a<span style="color:#f92672">+</span>b
        n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span>
fib(<span style="color:#ae81ff">6</span>)
<span style="color:#75715e"># &gt;&gt;&gt;</span>
<span style="color:#75715e"># 1</span>
<span style="color:#75715e"># 1</span>
<span style="color:#75715e"># 2</span>
<span style="color:#75715e"># 3</span>
<span style="color:#75715e"># 5</span>
<span style="color:#75715e"># 8</span>
</code></pre></div><p>改进为一个generator<br>
如果一个函数定义中包含<code>yield</code>关键字，这个函数就不再是一个普通的函数，而是一个generator</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># generator</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fib</span>(max):
    n, a, b <span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">while</span> n<span style="color:#f92672">&lt;</span>max:
        yeild b
        a, b <span style="color:#f92672">=</span>b, a<span style="color:#f92672">+</span>b
        n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> 
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;done&#39;</span>
</code></pre></div><ul>
<li>普通函数 遇到 <code>return</code> 返回</li>
<li>generator 遇到 <code>yeild</code> 返回</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">odd</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;step 1&#39;</span>)
    <span style="color:#66d9ef">yield</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;step 2&#39;</span>)
    <span style="color:#66d9ef">yield</span>(<span style="color:#ae81ff">3</span>)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;step 3&#39;</span>)
    <span style="color:#66d9ef">yield</span>(<span style="color:#ae81ff">5</span>)
o <span style="color:#f92672">=</span> odd()
next(o)
<span style="color:#75715e"># step 1</span>
<span style="color:#75715e"># 1</span>
next(o)
<span style="color:#75715e"># step 2</span>
<span style="color:#75715e"># 3</span>
next(o)
<span style="color:#75715e"># step 3</span>
<span style="color:#75715e"># 5</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fib</span>(max):
    n, a, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">while</span> n <span style="color:#f92672">&lt;</span> max:
        <span style="color:#66d9ef">yield</span> b
        a, b <span style="color:#f92672">=</span> b, a <span style="color:#f92672">+</span> b
        n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;done&#39;</span>

g <span style="color:#f92672">=</span> fib(<span style="color:#ae81ff">6</span>)
<span style="color:#66d9ef">while</span> True:
    <span style="color:#66d9ef">try</span>:
        x <span style="color:#f92672">=</span> next(g)
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;g=&#39;</span>,x)
    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">StopIteration</span> <span style="color:#66d9ef">as</span> e:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Generator return value:&#34;</span>,e<span style="color:#f92672">.</span>value)
        <span style="color:#66d9ef">break</span>
<span style="color:#75715e"># g= 1</span>
<span style="color:#75715e"># g= 1</span>
<span style="color:#75715e"># g= 2</span>
<span style="color:#75715e"># g= 3</span>
<span style="color:#75715e"># g= 5</span>
<span style="color:#75715e"># g= 8</span>
<span style="color:#75715e"># Generator return value: done</span>
</code></pre></div><h2 id="迭代器">迭代器</h2>
<p>可以直接用于<code>for</code>循环的对象统称为可迭代对象：<code>Iterable</code>
<code>list</code>/<code>tuple</code>/<code>dict</code>/<code>set</code>/<code>dict</code>/<code>str</code>/<code>generator function</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 用isinstance() 判断对象是否为 Iterable 对象</span>
<span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> Iterable 
isinstance([],Iterable) <span style="color:#75715e"># True</span>
</code></pre></div><p>可以被<code>next()</code>函数调用并不断返回下一个值的对象成为迭代器：<code>Iterator</code></p>
<ul>
<li>凡是可作用于for循环的对象都是Iterable类型；</li>
<li>凡是可作用于next()函数的对象都是Iterator类型，它们表示一个惰性计算的序列；</li>
<li><code>iter()</code>可把<code>list</code>/<code>dict</code>/<code>str</code>变成<code>Iterator</code></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">isinstance([],Iterator) <span style="color:#75715e"># False</span>
isinstance(iter([]),Itertor) <span style="color:#75715e"># True</span>
</code></pre></div><p><code>Iterator</code>可表示成一个无限大的数据流，例如全体自然数</p>
<blockquote>
<p><code>for</code>循环的本质就是不断调用<code>next()</code>函数实现的</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>]
    <span style="color:#66d9ef">pass</span>

<span style="color:#75715e"># 等价于</span>
it <span style="color:#f92672">=</span> iter([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>])
<span style="color:#66d9ef">while</span> Ture:
    <span style="color:#66d9ef">try</span>:
        <span style="color:#75715e"># 获取下一个值</span>
        x <span style="color:#f92672">=</span> next(it)
    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">StopIteration</span>:
        <span style="color:#75715e"># 遇到StopIteration就退出循环</span>
        <span style="color:#66d9ef">break</span>
</code></pre></div><h2 id="高阶函数">高阶函数</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">abs(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>) <span style="color:#75715e"># 10</span>
abs      <span style="color:#75715e"># &lt;built-in function abs&gt;</span>
<span style="color:#75715e"># abs(-10) 是函数调用</span>
<span style="color:#75715e"># abs 是函数本身</span>

x <span style="color:#f92672">=</span> abs(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>) <span style="color:#75715e"># 可以把结果赋值给变量</span>
f <span style="color:#f92672">=</span> abs      <span style="color:#75715e"># 也可以把函数赋值给变量</span>
<span style="color:#75715e"># 变量指向这个函数</span>
f(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>) <span style="color:#75715e"># 10</span>

<span style="color:#75715e"># 函数名也是个变量</span>
abs <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span> 
<span style="color:#66d9ef">print</span>(abs) <span style="color:#75715e"># 10 此时abs指向的是10这个整数</span>
</code></pre></div><ul>
<li>变量能指向函数</li>
<li>函数的参数能接受变量</li>
</ul>
<blockquote>
<p>一个函数可以接收另一个函数作为参数，这种函数被称之为<strong>高阶函数</strong></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(x,y,f):
    <span style="color:#66d9ef">return</span> f(x)<span style="color:#f92672">+</span>f(y)
add(<span style="color:#ae81ff">5</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>,abs) <span style="color:#75715e"># 11</span>
</code></pre></div><h2 id="mapreduce">map/reduce</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 有一个函数f(x)，把这个函数作用在一个list上</span>
<span style="color:#75715e"># 假设函数f(x)=x^2</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>(x):
    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">*</span>x
r <span style="color:#f92672">=</span> map(f,[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">9</span>])
list(r) <span style="color:#75715e"># [1,4,9,16,25,36,49,64,81]</span>
r       <span style="color:#75715e"># map object</span>

<span style="color:#75715e"># 用循环实现</span>
L <span style="color:#f92672">=</span> [] 
<span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">9</span>]:
    L<span style="color:#f92672">.</span>append(f(n))
<span style="color:#66d9ef">print</span>(L)
<span style="color:#75715e"># 不能一眼看出，把f(x)作用在list的每一个元素上，并把结果生成一个新的list</span>
</code></pre></div><p><code>map()</code>作为高阶函数，把运算规则抽象化</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 把所有数字变成字符串</span>
list(map(str,[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">9</span>]))
<span style="color:#75715e"># [&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;]</span>
</code></pre></div><p><code>reduce()</code>把一个函数作用在一个序列<code>[x1,x2,x3,...]</code>上，这个函数必须接受两个参数，<code>reduce</code>把结果继续和序列的下一个元素做累计计算</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> reduce

<span style="color:#75715e"># example</span>
reduce(f,[x1,x2,x3,x4]) <span style="color:#75715e"># 等价f(f(f(x1,x2),x3),x4)</span>

<span style="color:#75715e"># 利用reduce写阶乘</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">multiple</span>(a,b):
    <span style="color:#66d9ef">return</span> a<span style="color:#f92672">*</span>b
L <span style="color:#f92672">=</span> list(range(<span style="color:#ae81ff">6</span>))[<span style="color:#ae81ff">1</span>:] <span style="color:#75715e"># [1,2,3,4,5]</span>
reduce(multiple,L) <span style="color:#75715e"># 5!=120</span>

<span style="color:#75715e"># 将 [1,3,5,7] 变成整数 1357</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(x,y):
    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">*</span><span style="color:#ae81ff">10</span><span style="color:#f92672">+</span>y
reduce(add,[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">7</span>]) <span style="color:#75715e"># 1357</span>

<span style="color:#75715e"># 写成匿名函数的形式</span>
reduce(<span style="color:#66d9ef">lambda</span> x,y :x<span style="color:#f92672">*</span><span style="color:#ae81ff">10</span><span style="color:#f92672">+</span>y,[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">7</span>])
</code></pre></div><p>将 <code>map()</code>和<code>recude()</code>结合</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># str2int</span>
<span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> reduce
DIGITS <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;0&#39;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#e6db74">&#39;1&#39;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;2&#39;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#39;3&#39;</span>:<span style="color:#ae81ff">3</span>,<span style="color:#e6db74">&#39;4&#39;</span>:<span style="color:#ae81ff">4</span>,<span style="color:#e6db74">&#39;5&#39;</span>:<span style="color:#ae81ff">5</span>,<span style="color:#e6db74">&#39;6&#39;</span>:<span style="color:#ae81ff">6</span>,<span style="color:#e6db74">&#39;7&#39;</span>:<span style="color:#ae81ff">7</span>,<span style="color:#e6db74">&#39;8&#39;</span>:<span style="color:#ae81ff">8</span>,<span style="color:#e6db74">&#39;9&#39;</span>:<span style="color:#ae81ff">9</span>}

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">str2int</span>(s):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fn</span>(x,y):
        <span style="color:#66d9ef">return</span> x<span style="color:#f92672">*</span><span style="color:#ae81ff">10</span><span style="color:#f92672">+</span>y
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">char2num</span>(s):
        <span style="color:#66d9ef">return</span> DIGTIS[s]
    <span style="color:#66d9ef">return</span> reduce(fn,map(char2num,s))
<span style="color:#75715e"># lambda 函数简化</span>
<span style="color:#75715e"># def char2num(s):</span>
<span style="color:#75715e">#   return DIHTIS[s]</span>
<span style="color:#75715e"># def str2int(s):</span>
<span style="color:#75715e">#   return reduce(lambda x,y:x*10+y,map(char2num,s))</span>
</code></pre></div><h2 id="filter">filter</h2>
<p><code>filter()</code>函数用于过滤序列<br>
<code>filter()</code>把传入的函数依次作用于每个元素，然后根据返回值是<code>True</code>还是<code>False</code>决定保留还是丢弃该元素</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 保留偶数</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">is_even</span>(n):
    <span style="color:#66d9ef">return</span> n <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>
list(filter(is_even,[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">15</span>]))
<span style="color:#75715e"># [2,4,6,8,10]</span>
</code></pre></div><p>删去空字符串</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">not_empty</span>(s):
    <span style="color:#66d9ef">return</span> s <span style="color:#f92672">and</span> s<span style="color:#f92672">.</span>strip()
list(filter(not_empty,[<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>,None,<span style="color:#e6db74">&#39;C&#39;</span>,<span style="color:#e6db74">&#39;   &#39;</span>]))
<span style="color:#75715e"># [&#39;A&#39;,&#39;B&#39;,&#39;C&#39;]</span>

<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;&#39;</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;True&#39;</span>)
<span style="color:#66d9ef">else</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;False&#39;</span>)
<span style="color:#75715e"># False</span>

<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;   &#39;</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Ture&#39;</span>)
<span style="color:#66d9ef">else</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;False&#39;</span>)
<span style="color:#75715e"># True</span>
<span style="color:#75715e"># strip()可以去除头尾的所有空格</span>
</code></pre></div><p><code>filter()</code>函数返回的是一个<code>Itertor</code>，也就是一个惰性序列</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 埃氏筛法</span>
<span style="color:#75715e"># 先构造一个从3开始的奇数序列</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_odd_iter</span>():
    n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">while</span> True:
        n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>
        <span style="color:#66d9ef">yield</span> n
<span style="color:#75715e"># 定义一个筛选函数</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_not_divisible</span>(n):
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">lambda</span> x: x <span style="color:#f92672">%</span> n <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>
<span style="color:#75715e"># 定义一个生成器，不断返回下一个素数</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">primes</span>():
    <span style="color:#66d9ef">yield</span> <span style="color:#ae81ff">2</span>
    it <span style="color:#f92672">=</span> _odd_iter() <span style="color:#75715e"># 初始化序列</span>
    <span style="color:#66d9ef">while</span> True:
        n <span style="color:#f92672">=</span> next(it) <span style="color:#75715e"># 返回序列第一个数</span>
        <span style="color:#75715e"># 其实我不是很理解这里为啥第一个n=2</span>
        <span style="color:#66d9ef">yield</span> n
        it <span style="color:#f92672">=</span> filter(_not_divisible(n), it) <span style="color:#75715e"># 构造新序列</span>

<span style="color:#75715e"># 打印1000以内的素数</span>
<span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> primes():
    <span style="color:#66d9ef">if</span> n <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1000</span>:
        <span style="color:#66d9ef">print</span>(n)
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">break</span>
<span style="color:#75715e"># 因为peimes()是无限序列，所以一定要设置退出条件</span>
</code></pre></div><h2 id="sorted">sorted</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sorted([<span style="color:#ae81ff">36</span>,<span style="color:#ae81ff">5</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">9</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>])
<span style="color:#75715e"># [-21,-12,5,9,36]</span>

<span style="color:#75715e"># sorted()函数也是一个高阶函数，可以接受一个key函数</span>
sorted([<span style="color:#ae81ff">36</span>,<span style="color:#ae81ff">5</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">9</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>],key<span style="color:#f92672">=</span>abs)
<span style="color:#75715e"># [5,9,-12,-21,36]</span>
<span style="color:#75715e"># 先对list里的元素进行key函数的处理，然后排序后再转换回处理前</span>
<span style="color:#75715e"># 👆就是先取绝对值，排完序后变回取绝对值之前</span>

<span style="color:#75715e"># 反向排序</span>
sorted([<span style="color:#ae81ff">36</span>,<span style="color:#ae81ff">5</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">9</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>], reverse<span style="color:#f92672">=</span>True)
<span style="color:#75715e"># [36, 9, 5, -12, -12]</span>
</code></pre></div><h2 id="返回函数">返回函数</h2>
<p>高阶函数除了可以接受函数作为参数，还可以把函数作为结果值返回 (其实也很好理解，函数名就是个变量</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lazy_sum</span>(<span style="color:#f92672">*</span>args):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sum</span>():
        ax <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> args:
            ax <span style="color:#f92672">=</span> ax <span style="color:#f92672">+</span> n
        <span style="color:#66d9ef">return</span> ax
    <span style="color:#66d9ef">return</span> sum
f <span style="color:#f92672">=</span> lazy_sum()
f <span style="color:#75715e"># &lt;function lazy_sum.&lt;locals&gt;.sum at 0x00000000036FCB70&gt;</span>
<span style="color:#75715e"># f 是 sum()函数</span>
f() <span style="color:#75715e"># 25</span>
<span style="color:#75715e"># 调用函数 f 时，才真正计算求和的值</span>
</code></pre></div><p>我们在函数<code>lazy_sum</code>中又定义了函数<code>sum</code>，并且内部函数<code>sum</code>可以引用外部函数<code>lazy_sum</code>的参数和局部变量，当<code>lazy_sum</code>返回函数<code>sum</code>，相关参数和变量都保存在返回的函数中，这种称为&quot;闭包(Closure)&ldquo;的程序结构拥有极大的威力。</p>
<p>当我们调用<code>lazy_sum</code>时，每次调用都会返回一个新的函数，即使传入相同的参数：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">f1 <span style="color:#f92672">=</span> lazy_sum(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">7</span>)
f2 <span style="color:#f92672">=</span> lazy_sum(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">7</span>)
f1 <span style="color:#f92672">==</span> f2 <span style="color:#75715e"># False</span>
</code></pre></div><p><code>f1()</code>和<code>f2()</code>的调用结果互不影响</p>
<h2 id="闭包closure">闭包(Closure)</h2>
<p>闭包返回的函数没有立刻执行，而是等到调用了<code>f()</code>才执行：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">count</span>():
    fs <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4</span>):
        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>():
            <span style="color:#66d9ef">return</span> i<span style="color:#f92672">*</span>i
        fs<span style="color:#f92672">.</span>append(f)
    <span style="color:#66d9ef">return</span> fs
f1, f2, f3 <span style="color:#f92672">=</span>count() <span style="color:#75715e"># 此时没有调用f()，但是i已经等于了3</span>
f1() <span style="color:#75715e"># 9</span>
f2() <span style="color:#75715e"># 9</span>
f3() <span style="color:#75715e"># 9</span>
</code></pre></div><h2 id="匿名函数lambda">匿名函数lambda</h2>
<p><code>lambda x: x*x</code>等价于：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>(x):
    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">*</span>x
</code></pre></div><p><code>lambda</code>表示匿名函数，冒号前面的<code>x</code>表示函数参数</p>
<p>匿名函数有个限制，就是只能有一个表达式，不用写<code>return</code>，返回值就是该表达式的结果</p>
<p>匿名函数没有名字，不用担心函数名冲突，可以把匿名函数赋值给一个变量，再用此变量调用该函数：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">f <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x: x<span style="color:#f92672">*</span>x
f <span style="color:#75715e"># &lt;function &lt;lambda&gt; at 0x00000000036CD2F0&gt;</span>
f(<span style="color:#ae81ff">5</span>) <span style="color:#75715e"># 25</span>
</code></pre></div><p><code>lambda</code>函数也可以作为返回值返回</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build</span>(x ,y):
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">lambda</span> : x<span style="color:#f92672">*</span>x<span style="color:#f92672">+</span>y<span style="color:#f92672">*</span>y
f <span style="color:#f92672">=</span> build(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">5</span>)
f <span style="color:#75715e"># &lt;function build.&lt;locals&gt;.&lt;lambda&gt; at 0x000000000379CB70&gt;</span>
f() <span style="color:#75715e"># 26</span>
build(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>)() <span style="color:#75715e"># 25</span>
</code></pre></div><h2 id="装饰器decorator">装饰器(Decorator)</h2>
<p>函数对象有一个<code>___name__</code>属性，可以获得函数的名字</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">now</span>():
    <span style="color:#66d9ef">pass</span>
f <span style="color:#f92672">=</span> now
now<span style="color:#f92672">.</span>__name__ <span style="color:#75715e"># &#39;now&#39;</span>
f<span style="color:#f92672">.</span>__name__ <span style="color:#75715e"># &#39;now&#39;</span>
</code></pre></div><p>本质上<code>decoratoe</code>是一个返回函数的高阶函数</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 打印日志的log函数</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">log</span>(func):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">weapper</span>(<span style="color:#f92672">*</span>args,<span style="color:#f92672">**</span>kw):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;call </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">():&#39;</span><span style="color:#f92672">%</span>func<span style="color:#f92672">.</span>__name__)
        <span style="color:#66d9ef">return</span> func(<span style="color:#f92672">*</span>args,<span style="color:#f92672">**</span>kw)
    <span style="color:#66d9ef">return</span> wrapper
</code></pre></div><p><code>log</code>是一个<code>decorator</code>,接受一个函数作为参数，并返回一个函数，需要借助<code>Python</code>的<code>@</code>语法，把<code>decorator</code>置于函数的定义处：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@log</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">now</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;2019-8-12&#39;</span>)
now()
<span style="color:#75715e"># call now():</span>
<span style="color:#75715e"># 2019-8-12</span>
</code></pre></div><p>把<code>@log()</code>放到<code>now()</code>函数的定义处，相当于执行了语句</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">now <span style="color:#f92672">=</span> log(now)
</code></pre></div><p>如果<code>decorator</code>本身需要传入参数，会更加麻烦:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">log</span>(text):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decorator</span>(func):
        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args,<span style="color:#f92672">**</span>kw):
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">():&#39;</span> <span style="color:#f92672">%</span>(text,func<span style="color:#f92672">.</span>__name__))
            <span style="color:#66d9ef">return</span> func(<span style="color:#f92672">*</span>args,<span style="color:#f92672">**</span>kw)
        <span style="color:#66d9ef">return</span> wrapper
    <span style="color:#66d9ef">return</span> decorator
<span style="color:#a6e22e">@log</span>(<span style="color:#e6db74">&#39;execute&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">now</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;2019-8-12&#39;</span>)
now<span style="color:#f92672">.</span>__name__ <span style="color:#75715e"># &#39;wrapper&#39;</span>
</code></pre></div><p>经过<code>decorator</code>装饰之后的函数<code>__name__</code>会变<br>
有些通过签名函数来调用的代码会出错
所以需要把原始函数的<code>__name__</code>等属性复制到<code>wrapper()</code>函数中<br>
不需要编写<code>wrapper.__name__ = func.__name__</code>这样的代码，<br>
<code>Python</code>内置的了<code>functools.wraps</code>解决这个问题</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> functools

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">log</span>(func):
    <span style="color:#a6e22e">@functools.wraps</span>(func)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args,<span style="color:#f92672">**</span>kw):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;call </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">():&#39;</span> <span style="color:#f92672">%</span> func<span style="color:#f92672">.</span>__name__)
        <span style="color:#66d9ef">return</span> func(<span style="color:#f92672">*</span>args,<span style="color:#f92672">**</span>kw)
    <span style="color:#66d9ef">return</span> wrapper
</code></pre></div><h2 id="偏函数-partial-function">偏函数 Partial function</h2>
<p>当函数的参数个数太多，需要简化事时，使用<code>functools.partial</code>可以创建一个新的函数，这个新函数可以固定原函数的部分参数，从而调用的时候更加简单</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># int() 把字符串转成整数，默认10转10</span>
<span style="color:#75715e"># 提供额外参数base,表示字符串内容的进制</span>
int(<span style="color:#e6db74">&#39;123&#39;</span>) <span style="color:#75715e"># 123</span>
int(<span style="color:#e6db74">&#39;12345&#39;</span>, base<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>) <span style="color:#75715e"># 5349</span>
int(<span style="color:#e6db74">&#39;12345&#39;</span>, <span style="color:#ae81ff">16</span>) <span style="color:#75715e"># 74565</span>

<span style="color:#75715e"># 当有大量的二进制字符串需要转换，每次都用int(x, base=2)很麻烦</span>
<span style="color:#75715e"># 可以定义一个int2()函数，把默认base=2传入</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">int2</span>(x,base<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>):
    <span style="color:#66d9ef">return</span> int(x, base)
int2(<span style="color:#e6db74">&#39;1000000&#39;</span>) <span style="color:#75715e"># 64</span>
</code></pre></div><p>我们可以用<code>functools.partial</code>创建一个偏函数，不需要自己定义<code>int2()</code>，可以用下面的代码创建一个新函数<code>int2()</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> functools.partial

int2 <span style="color:#f92672">=</span> functools<span style="color:#f92672">.</span>partial(int, base<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
int2(<span style="color:#e6db74">&#39;1000000&#39;</span>) <span style="color:#75715e"># 64</span>
</code></pre></div><h2 id="模块-module">模块 Module</h2>
<ul>
<li>可以避免<strong>函数名</strong>和<strong>变量名</strong>冲突</li>
<li>使用包(Package)避免模块名冲突
<ul>
<li>包里必须含有<code>__init__.py</code>,他的模块名和包名一致</li>
</ul>
</li>
</ul>
<p>! 自己创建的模块名字不能与<code>Python</code>自带的模块名小冲突</p>
<p><code>#!/usr/bin/env python3</code>可以让<code>.py</code>文件直接在Unix/Linux/Mac上运行<br>
<code># -*- coding: utf-8 -*-</code>注释表示<code>.py</code>文件本身使用标准<code>UTF-8</code>编码</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python3</span>
<span style="color:#75715e"># -*- coding: utf-8 -*-</span>

<span style="color:#e6db74">&#39; a test module &#39;</span>

__author__ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Luo&#39;</span>

<span style="color:#f92672">import</span> sys

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test</span>():
    args <span style="color:#f92672">=</span> sys<span style="color:#f92672">.</span>argv
    <span style="color:#66d9ef">if</span> len(args)<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Hello, world!&#39;</span>)
    <span style="color:#66d9ef">elif</span> len(args)<span style="color:#f92672">==</span><span style="color:#ae81ff">2</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Hello, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">!&#39;</span> <span style="color:#f92672">%</span> args[<span style="color:#ae81ff">1</span>])
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Too many arguments!&#39;</span>)

<span style="color:#66d9ef">if</span> __name__<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    test()
</code></pre></div><p>if <code>__name__ == '__main__'</code> 的意思是：</p>
<p>当 <code>.py</code> 文件被直接运行时，<code>if __name__ == '__main__'</code> 之下的代码块将被运行；</p>
<p>当 <code>.py</code> 文件以模块形式被导入时，<code>if __name__ == '__main__'</code> 之下的代码块不会被运行。</p>
<h3 id="作用域">作用域</h3>
<p>正常的函数和变量名是公开的(public)，可以直接被引用<br>
类似<code>__xxx__</code>这样的变量是特殊变量，可以直接被引用，但是有特殊用途，一般自己这样命名<br>
类似<code>_xxx</code>和<code>__xxx</code>这样的函数或变量就是非公开的(private)，不应该直接被引用<br>
一般外部不需要引用的函数全部定义成private，只有外部需要引用的才定义为public</p>
<h3 id="安装第三方库">安装第三方库</h3>
<p>Windows用<code>pip</code></p>
<h2 id="oop">OOP</h2>
<ul>
<li>类(Class)</li>
<li>实例(Instance)</li>
<li>属性(Property)</li>
<li>方法(Method)</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):

    <span style="color:#66d9ef">def</span> __init__(self, name, score):
        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> name
        self<span style="color:#f92672">.</span>score <span style="color:#f92672">=</span> score

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">print_score</span>(self):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> : </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span>(self<span style="color:#f92672">.</span>name, self<span style="color:#f92672">.</span>score))
bart <span style="color:#f92672">=</span> Student(<span style="color:#e6db74">&#39;Bart Simpson&#39;</span>, <span style="color:#ae81ff">59</span>)
bart<span style="color:#f92672">.</span>print_score()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self, name, score): 
    <span style="color:#75715e"># 第一个参数永远是self</span>
    <span style="color:#75715e"># 表示创建的实例本身</span>
    <span style="color:#75715e"># 有了该方法，创建实例时必须传入匹配的参数</span>
        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> name 
        self<span style="color:#f92672">.</span>score <span style="color:#f92672">=</span> score
    <span style="color:#75715e"># 定义时 self 放在参数第一个参数</span>
    <span style="color:#75715e"># 其他参数正常传入</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">print_score</span>(self, n):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39; </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">: </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span>(self<span style="color:#f92672">.</span>name, self<span style="color:#f92672">.</span>score<span style="color:#f92672">*</span>n)) 
bart <span style="color:#f92672">=</span> Student(<span style="color:#e6db74">&#39;Bart&#39;</span>,<span style="color:#ae81ff">90</span>)
bart<span style="color:#f92672">.</span>print_score(<span style="color:#ae81ff">3</span>) <span style="color:#75715e"># Bart : 270</span>
</code></pre></div><p>！特殊方法<code>__init__</code>前后分别有两个下划线</p>
<h2 id="访问限制">访问限制</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">bar <span style="color:#f92672">=</span> Student(<span style="color:#e6db74">&#39;Bart&#39;</span>, <span style="color:#ae81ff">59</span>)
<span style="color:#75715e"># 外部代码可自由修改</span>
bart<span style="color:#f92672">.</span>score <span style="color:#75715e"># 59</span>
bart<span style="color:#f92672">.</span>score <span style="color:#f92672">=</span> <span style="color:#ae81ff">99</span> 
vart<span style="color:#f92672">.</span>score <span style="color:#75715e"># 99</span>

<span style="color:#75715e"># 让内部属性不被外部访问</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self, name, score):
        self<span style="color:#f92672">.</span>__name <span style="color:#f92672">=</span> name
        self<span style="color:#f92672">.</span>__score <span style="color:#f92672">=</span> score
    
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">print_score</span>(self):
        <span style="color:#66d9ef">pass</span>
</code></pre></div><p>此时已经无法在外部访问<code>实例变量.__name</code>和<code>实例变量.__score</code><br>
此时想要获取<code>name</code>和<code>score</code>可以增加方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    <span style="color:#f92672">...</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_name</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>__name
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_score</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>__score
</code></pre></div><p>如果想要允许外部代码修改<code>score</code>怎么办<br>
可以继续增加方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_name</span>(self, name):
        self<span style="color:#f92672">.</span>__name <span style="color:#f92672">=</span> name
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_score</span>(self, score):
        self<span style="color:#f92672">.</span>__score <span style="color:#f92672">=</span> score
</code></pre></div><p>虽然之前的<code>bart.score = 99</code>也可以修改，
但是这样可以做参数检查：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(Object):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_score</span>(self, score):
        <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;=</span> score <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">100</span>:
            self<span style="color:#f92672">.</span>__score <span style="color:#f92672">=</span> score
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#39;bad score&#39;</span>)
</code></pre></div><blockquote>
<p>坑！！！</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Python解释器会将私有变量__name改成_Student__name</span>
<span style="color:#75715e"># 所以仍可以通过_Student__name来访问私有变量</span>
<span style="color:#75715e"># 但是不同的解释器可能会改不同的变量名</span>
bart <span style="color:#f92672">=</span> Student(<span style="color:#e6db74">&#39;Bart&#39;</span> ,<span style="color:#ae81ff">59</span>)
bart<span style="color:#f92672">.</span>_Student__name <span style="color:#75715e"># &#39;Bart&#39;</span>
bart<span style="color:#f92672">.</span>get_name() <span style="color:#75715e"># &#39;Bart&#39;</span>
bart<span style="color:#f92672">.</span>__name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;New Name&#39;</span> <span style="color:#75715e"># 设置__name变量!</span>
bart<span style="color:#f92672">.</span>__name <span style="color:#75715e"># &#39;New Name&#39;</span>
bart<span style="color:#f92672">.</span>get_name() <span style="color:#75715e"># &#39;Bart&#39;</span>
</code></pre></div><h2 id="继承和多态">继承和多态</h2>
<p>在我们定义一个class，从某个现有的class继承，<br>
新的class称为<code>子类 Subclass</code><br>
而被继承的class被称为基类、父类或超类<code>Base class/Super class</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Animal</span>(object):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Animal is running&#39;</span>)
</code></pre></div><p>编写<code>Dog</code>和<code>Cat</code>类的时候可以直接从<code>Animal</code>类继承</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dog</span>(Animal):
    <span style="color:#66d9ef">pass</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Cat</span>(Animal):
    <span style="color:#66d9ef">pass</span>
</code></pre></div><p>子类会继承父类的全部功能，所以:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dog <span style="color:#f92672">=</span> Dog()
cat <span style="color:#f92672">=</span> Cat()
dog<span style="color:#f92672">.</span>run() <span style="color:#75715e"># Animal is running </span>
cat<span style="color:#f92672">.</span>run()  <span style="color:#75715e"># Animal is running</span>
</code></pre></div><p>当然我们可以让<code>Dog</code>类的<code>run</code>方法被覆盖：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 覆盖父类的run方法</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dog</span>(Animal):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Dog is running...&#39;</span>)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">eat</span>(self):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Eating meat...&#39;</span>)
dog <span style="color:#f92672">=</span> Dog()
dog<span style="color:#f92672">.</span>run() <span style="color:#75715e"># Dog is running...</span>
</code></pre></div><p>子类的<code>run()</code>覆盖了父类的<code>run()</code>，在代码运行时，总是会调用子类的<code>run()</code>，这里是继承的另一个好处：多态</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> list()
b <span style="color:#f92672">=</span> Animal()
c <span style="color:#f92672">=</span> Dog()
isinstance(a, list) <span style="color:#75715e"># True</span>
isinstance(b, Animal) <span style="color:#75715e"># True</span>
isinstance(c, Dog) <span style="color:#75715e"># True</span>
<span style="color:#75715e"># 除此之外</span>
isinstance(c, Animal) <span style="color:#75715e"># True </span>
<span style="color:#75715e"># Dog 可以看成 Animal</span>
<span style="color:#75715e"># but</span>
isinstance(b, Dag) <span style="color:#75715e"># False</span>
<span style="color:#75715e"># Animal 不可以看成 Dog</span>
<span style="color:#75715e"># 以上应该很好理解</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run_twice</span>(animal()):
    animal<span style="color:#f92672">.</span>run()
    animal<span style="color:#f92672">.</span>run()
run_twice(Animal)
<span style="color:#75715e"># Animal is running</span>
<span style="color:#75715e"># Animal is running</span>

<span style="color:#75715e"># 定义一个Timer类</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Timer</span>(object):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Start...&#39;</span>)
run_twice(Timer())
<span style="color:#75715e"># Start...</span>
<span style="color:#75715e"># Start...</span>
</code></pre></div><p>以上被叫做动态语言的“鸭子”类行，不要求严格的继承体系，一个对象只要“看起来像鸭子，走起路来像鸭子”，那他就可以被看作是鸭子<br>
上面这个例子，只需要是个对象，并且有<code>run()</code>方法即可</p>
<h2 id="获取对象信息">获取对象信息</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 判断对象类型</span>
<span style="color:#75715e"># 基本类型都可以用 type() 判断</span>
type(<span style="color:#ae81ff">123</span>) <span style="color:#75715e"># &lt;class &#39;int&#39;&gt;</span>
type(<span style="color:#e6db74">&#39;str&#39;</span>) <span style="color:#75715e"># &lt;class &#39;str&#39;&gt;</span>
type(None) <span style="color:#75715e"># &lt;type(None) &#39;NoneType&#39;&gt; </span>

<span style="color:#75715e"># 如果一个变量指向函数或者类，也可以用type() 判断</span>
type(abs)
<span style="color:#75715e"># &lt;class &#39;builtin_function_or_method&#39;&gt;</span>
</code></pre></div><p><code>type()</code>返回的是对应的Class类型</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">type(<span style="color:#ae81ff">123</span>) <span style="color:#f92672">==</span> type(<span style="color:#ae81ff">456</span>) <span style="color:#75715e"># True</span>
type(<span style="color:#ae81ff">123</span>) <span style="color:#f92672">==</span> int <span style="color:#75715e"># True</span>
type(<span style="color:#ae81ff">123</span>) <span style="color:#f92672">==</span> type(<span style="color:#e6db74">&#39;str&#39;</span>) <span style="color:#75715e"># False</span>
</code></pre></div><p>判断基本类型可以直接写<code>int</code>,<code>str</code>等，<br>
判断一个对象是否是函数，可以使用<code>types</code>中定义的常量</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> types

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fn</span>():
    <span style="color:#66d9ef">pass</span>
type(fn) <span style="color:#f92672">==</span> types<span style="color:#f92672">.</span>FunctionType <span style="color:#75715e"># True</span>
type(abs) <span style="color:#f92672">==</span> types<span style="color:#f92672">.</span>BuiltinFunctionType <span style="color:#75715e"># True</span>
type(<span style="color:#66d9ef">lambda</span> x: x) <span style="color:#f92672">==</span> types<span style="color:#f92672">.</span>LambdaType <span style="color:#75715e"># True</span>
type((x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>))) <span style="color:#f92672">==</span> types<span style="color:#f92672">.</span>GeneratorType <span style="color:#75715e"># True</span>
</code></pre></div><p>判断继承关系时，用<code>type()</code>比较的不方便，可以用<code>isinstance()</code>判断<br>
能用<code>type()</code>判断的基本类型也可用<code>isinstance()</code>判断：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">isinstance(<span style="color:#e6db74">&#39;s&#39;</span>,str) <span style="color:#75715e"># True</span>
isinstance(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span>,bytes) <span style="color:#75715e"># True</span>

<span style="color:#75715e"># 可以判断一个变量是否是某些类型中的一种</span>
isinstance([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>], (list, tuple)) <span style="color:#75715e"># True</span>
isinstance((<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>), (list, tuple)) <span style="color:#75715e"># True</span>
</code></pre></div><p>判断类型的的时候总是优先使用<code>isinstance()</code></p>
<p>如果要获得一个对象的所有属性和方法，可以使用<code>dir()</code>函数，它返回一个包含字符串的list，比如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dir(<span style="color:#e6db74">&#39;ABC&#39;</span>)
<span style="color:#75715e"># [&#39;__add__&#39;, &#39;__class__&#39;, &#39;__contains__&#39;, &#39;__delattr__&#39;, &#39;__dir__&#39;, &#39;__doc__&#39;, &#39;__eq__&#39;, &#39;__format__&#39;, &#39;__ge__&#39;, &#39;__getattribute__&#39;, &#39;__getitem__&#39;, &#39;__getnewargs__&#39;, &#39;__gt__&#39;, &#39;__hash__&#39;, &#39;__init__&#39;, &#39;__init_subclass__&#39;, &#39;__iter__&#39;, &#39;__le__&#39;, &#39;__len__&#39;, &#39;__lt__&#39;, &#39;__mod__&#39;, &#39;__mul__&#39;, &#39;__ne__&#39;, &#39;__new__&#39;, &#39;__reduce__&#39;, &#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__rmod__&#39;, &#39;__rmul__&#39;, &#39;__setattr__&#39;, &#39;__sizeof__&#39;, &#39;__str__&#39;, &#39;__subclasshook__&#39;, &#39;capitalize&#39;, &#39;casefold&#39;, &#39;center&#39;, &#39;count&#39;, &#39;encode&#39;, &#39;endswith&#39;, &#39;expandtabs&#39;, &#39;find&#39;, &#39;format&#39;, &#39;format_map&#39;, &#39;index&#39;, &#39;isalnum&#39;, &#39;isalpha&#39;, &#39;isascii&#39;, &#39;isdecimal&#39;, &#39;isdigit&#39;, &#39;isidentifier&#39;, &#39;islower&#39;, &#39;isnumeric&#39;, &#39;isprintable&#39;, &#39;isspace&#39;, &#39;istitle&#39;, &#39;isupper&#39;, &#39;join&#39;, &#39;ljust&#39;, &#39;lower&#39;, &#39;lstrip&#39;, &#39;maketrans&#39;, &#39;partition&#39;, &#39;replace&#39;, &#39;rfind&#39;, &#39;rindex&#39;, &#39;rjust&#39;, &#39;rpartition&#39;, &#39;rsplit&#39;, &#39;rstrip&#39;, &#39;split&#39;, &#39;splitlines&#39;, &#39;startswith&#39;, &#39;strip&#39;, &#39;swapcase&#39;, &#39;title&#39;, &#39;translate&#39;, &#39;upper&#39;, &#39;zfill&#39;]</span>
</code></pre></div><p>模块</p>
<p>类似<code>__xxx__</code>的属性和方法在Python种都是有特殊用途的，比如<code>__len__</code>返回长度。在Python中，如果你调用<code>len()</code>函数试图获取一个对象的长度，实际上，在<code>len()</code>内部，它自动去调用该对象的<code>__len__()</code>方法，所以：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">len(<span style="color:#e6db74">&#39;asd&#39;</span>) <span style="color:#75715e"># 3</span>
<span style="color:#e6db74">&#39;asd&#39;</span><span style="color:#f92672">.</span>__len__() <span style="color:#75715e"># 3</span>
</code></pre></div><p>自己写的类，如果也想用<code>len(myobj)</code>的话，就自己写一个<code>__len__()</code>方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyDog</span>(object):    
    <span style="color:#66d9ef">def</span> __len__(self):
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">100</span>
dog <span style="color:#f92672">=</span> MyDog()
len(dog) <span style="color:#75715e"># 100</span>
</code></pre></div><p>剩下的是普通属性或方法，比如<code>lower()</code>返回小写的字符串：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#e6db74">&#39;ABC&#39;</span><span style="color:#f92672">.</span>lower() <span style="color:#75715e"># &#39;abc&#39;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 用getattr()/hasattr()/hasattr()</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyObject</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">power</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>x<span style="color:#f92672">*</span>self<span style="color:#f92672">.</span>x
obj <span style="color:#f92672">=</span> MyObject()
hasattr(obj, <span style="color:#e6db74">&#39;x&#39;</span>) <span style="color:#75715e"># 有属性 &#39;x&#39; 吗？# True</span>
obj<span style="color:#f92672">.</span>x <span style="color:#75715e"># 9</span>
hasattr(obj, <span style="color:#e6db74">&#39;y&#39;</span>) <span style="color:#75715e"># 有属性 &#39;y&#39; 吗？# False</span>
setattr(obj, <span style="color:#e6db74">&#39;y&#39;</span>, <span style="color:#ae81ff">19</span>) <span style="color:#75715e"># 设置一个属性 &#39;y&#39;</span>
hasattr(obj, <span style="color:#e6db74">&#39;y&#39;</span>) <span style="color:#75715e"># 有属性 &#39;y&#39; 吗？# True</span>
getattr(obj, <span style="color:#e6db74">&#39;y&#39;</span>) <span style="color:#75715e"># 获取属性 &#39;y&#39; # 19</span>
obj<span style="color:#f92672">.</span>y <span style="color:#75715e"># 19</span>

<span style="color:#75715e"># 如果试图获取不存在的属性，会抛出AttributeError的错误</span>
getattr(obj, <span style="color:#e6db74">&#39;z&#39;</span>) <span style="color:#75715e"># 获取属性&#39;z&#39;</span>
<span style="color:#75715e"># Traceback (most recent call last):</span>
<span style="color:#75715e">#   File &#34;&lt;stdin&gt;&#34;, line 1, in &lt;module&gt;</span>
<span style="color:#75715e"># AttributeError: &#39;MyObject&#39; object has no attribute &#39;z&#39;</span>

<span style="color:#75715e"># 可以传入一个default参数，如果属性不存在，就返回默认值</span>
getattr(obj, <span style="color:#e6db74">&#39;z&#39;</span>, <span style="color:#ae81ff">404</span>) <span style="color:#75715e"># 404</span>
</code></pre></div><p>也可以获得对象的方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">hasattr(obj, <span style="color:#e6db74">&#39;power&#39;</span>) <span style="color:#75715e"># 有属性 &#39;power&#39; 吗？# True</span>
getattr(obj, <span style="color:#e6db74">&#39;power&#39;</span>) <span style="color:#75715e"># 获取属性 &#39;power&#39;</span>
fn <span style="color:#f92672">=</span> getattr(obj, <span style="color:#e6db74">&#39;power&#39;</span> ) <span style="color:#75715e"># 获取属性 &#39;power&#39; 并赋值到变量fn</span>
fn <span style="color:#75715e">#指向 obj.power</span>
fn() <span style="color:#75715e"># 81</span>
</code></pre></div><p>一般只有在不知道对象信息的时候，我们才会取获取对象信息：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 如果可以直接写:</span>
sum <span style="color:#f92672">=</span> obj<span style="color:#f92672">.</span>x <span style="color:#f92672">+</span>obj<span style="color:#f92672">.</span>y

<span style="color:#75715e"># 就不要写:</span>
sum <span style="color:#f92672">=</span> getattr(obj, <span style="color:#e6db74">&#39;x&#39;</span>) <span style="color:#f92672">+</span> getattr(obj, <span style="color:#e6db74">&#39;y&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 正确用法</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">readImage</span>(fp):
    <span style="color:#66d9ef">if</span> hasattr(fp, <span style="color:#e6db74">&#39;read&#39;</span>):
        <span style="color:#66d9ef">return</span> readData(fp)
    <span style="color:#66d9ef">return</span> None
</code></pre></div><h2 id="实例属性和类属性">实例属性和类属性</h2>
<p>由于Python是动态语言，根据类创建的实例可以任意绑定属性<br>
给实例绑定属性的方法是通过实例变量，或者通过<code>self</code>变量：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self, name):
        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> name
s <span style="color:#f92672">=</span> Student(<span style="color:#e6db74">&#39;Bob&#39;</span>)
s<span style="color:#f92672">.</span>score
</code></pre></div><p>如果<code>Student</code>类本身要绑定一个属性，可以在class中定义属性，这种属性是类属性，归<code>Student</code>类所有：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Student&#39;</span>
</code></pre></div><p>这个属性虽然归类所有，但类的所有实例都可以访问：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Student&#39;</span>

s <span style="color:#f92672">=</span> Student() <span style="color:#75715e"># 创建实例s</span>
<span style="color:#66d9ef">print</span>(s<span style="color:#f92672">.</span>name) <span style="color:#75715e"># 打印name属性，因为实例并没有name属性，所有会继续查找class的name属性</span>
<span style="color:#75715e"># Student</span>
<span style="color:#66d9ef">print</span>(Student<span style="color:#f92672">.</span>name) <span style="color:#75715e"># 打印类的name属性</span>
<span style="color:#75715e"># Student</span>
s<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Bob&#39;</span> <span style="color:#75715e"># 给实例绑定name属性</span>
<span style="color:#66d9ef">print</span>(s<span style="color:#f92672">.</span>name) <span style="color:#75715e"># 由于实例属性优先级比类属性高，因此它会屏蔽掉类的属性</span>
<span style="color:#75715e"># Bob</span>
<span style="color:#66d9ef">print</span>(Student<span style="color:#f92672">.</span>name) <span style="color:#75715e"># 但是类属性并未消失，用Student.name仍然可以访问</span>
<span style="color:#75715e"># Student</span>
<span style="color:#66d9ef">del</span> s<span style="color:#f92672">.</span>name <span style="color:#75715e"># 如果删除实例的name属性</span>
<span style="color:#66d9ef">print</span>(s<span style="color:#f92672">.</span>name) <span style="color:#75715e"># 再次调用s.name，由于实力的name属性没有找到，类的name属性就显示出来了</span>
<span style="color:#75715e"># Student</span>
</code></pre></div><blockquote>
<p>实例属性属于各个实例所有，互不干扰；<br>
类属性属于类所有，所有实例共享一个属性；<br>
不要对实例属性和类属性使用相同的名字，否则将产生难以发现的错误。</p>
</blockquote>
<h2 id="使用__slots__">使用<code>__slots__</code></h2>
<p>我们定义了一个class，创建了一个class的实例后，可以对这个实例绑定任意的属性和方法，这就是动态语言的灵活性。定义一个class：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    <span style="color:#66d9ef">pass</span>
</code></pre></div><p>然后创建一个实例，给这个实例绑定一个属性</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">s <span style="color:#f92672">=</span> Student()
s<span style="color:#f92672">.</span>score <span style="color:#f92672">=</span> <span style="color:#ae81ff">97</span>
<span style="color:#66d9ef">print</span>(s<span style="color:#f92672">.</span>score)
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#ae81ff">97</span>
</code></pre></div><p>除此之外，我们可以给实例绑定一个方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 先定义一个函数作为实例对象</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_age</span>(self, age):
    aelf<span style="color:#f92672">.</span>age <span style="color:#f92672">=</span> age

<span style="color:#75715e"># 需要用到某个模块</span>
<span style="color:#f92672">from</span> types <span style="color:#f92672">import</span> MethodType
s<span style="color:#f92672">.</span>set_age <span style="color:#f92672">=</span> MethodType(set_age, s) <span style="color:#75715e"># 绑定方法</span>
s<span style="color:#f92672">.</span>set_age(<span style="color:#ae81ff">25</span>) <span style="color:#75715e"># 调用实例方法</span>
s<span style="color:#f92672">.</span>age <span style="color:#75715e"># 25</span>
</code></pre></div><p>但是绑定方法是独立的，对另外的实例是不起作用的：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">s2 <span style="color:#f92672">=</span> Student()
s2<span style="color:#f92672">.</span>set_age(<span style="color:#ae81ff">25</span>) <span style="color:#75715e"># 此时会报AttributeError错误</span>
<span style="color:#75715e"># 因为s2没有这个方法</span>
</code></pre></div><p>如果要对创建的实例都绑定一个方法，可以直接对class去绑定方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_score</span>(self, score):
    self<span style="color:#f92672">.</span>score <span style="color:#f92672">=</span> score
Student<span style="color:#f92672">.</span>set_score <span style="color:#f92672">=</span> set_score
s<span style="color:#f92672">.</span>set_score(<span style="color:#ae81ff">100</span>)
s<span style="color:#f92672">.</span>score <span style="color:#75715e"># 100</span>
</code></pre></div><p>如果要限制实例的属性怎么办?比如只允许添加<code>age</code>和<code>name</code>变量<br>
可以在定义class的时候，定义一个特殊的变量<code>__slots__</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    __slots__ <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;name&#39;</span>, <span style="color:#e6db74">&#39;age&#39;</span>) <span style="color:#75715e"># 用tuple定义允许绑定的属性名称</span>
</code></pre></div><p>！<code>__slots__</code>只对当前类的实例起作用，对其继承的子类是不起作用的<br>
除非在子类中也定义<code>__slots__</code>，这样，子类实例允许定义的属性就是自身的<code>__slots__</code>和父类的<code>__slots__</code></p>
<h2 id="使用property">使用@property</h2>
<p>在前面学了为了数据的安全，可以在类定义时设置<code>get()</code>和<code>set()</code>方法，这种方法还可以对数据进行检查</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_score</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_score
    
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_score</span>(self, score):
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isinstance(score, int):
            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#39;score must be an integer&#39;</span>)
        <span style="color:#66d9ef">if</span> score <span style="color:#f92672">&lt;</span> <span style="color:#f92672">or</span> score <span style="color:#f92672">&gt;</span><span style="color:#ae81ff">100</span>:
            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#39;score must between 0 ~ 100&#39;</span>)
        self<span style="color:#f92672">.</span>_score <span style="color:#f92672">=</span> score

s <span style="color:#f92672">=</span> Student()
s<span style="color:#f92672">.</span>set_score(<span style="color:#ae81ff">60</span>)
s<span style="color:#f92672">.</span>get_score() <span style="color:#75715e"># 60</span>
s<span style="color:#f92672">.</span>set_score(<span style="color:#ae81ff">9999</span>) <span style="color:#75715e"># ValueError : score must between 0 ~ 100</span>
</code></pre></div><p>上面的调用方法略显复杂，不如直接用属性这么直接简单<br>
所以我们需要既能检查参数，又可以用类似属性这样简单的方式来访问类的变量<br>
Python内置的<code>@property</code>装饰器就是负责把一个方法变成属性调用：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):

    <span style="color:#a6e22e">@property</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">score</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_score
    
    <span style="color:#a6e22e">@score.setter</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">score</span>(self, value):
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isinstance(value, int):
            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#39;score must be an integer!&#39;</span>)
        <span style="color:#66d9ef">if</span> value <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">or</span> value <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">100</span>:
            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#39;score must between 0 ~ 100&#39;</span>)
        self<span style="color:#f92672">.</span>_score <span style="color:#f92672">=</span> value
</code></pre></div><p><code>@property</code>的实现比较复杂，我们先考察如何使用。把一个<code>getter</code>方法变成属性，只需要加上<code>@property</code>就可以了，此时<code>@property</code>本身又创建了另一个装饰器<code>@score.setter</code>，负责把一个setter方法变成属性赋值，于是，我们就拥有一个可控的属性操作：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">s <span style="color:#f92672">=</span> Student()
s<span style="color:#f92672">.</span>score <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>  <span style="color:#75715e"># 实际转化为s.set_score(60)</span>
s<span style="color:#f92672">.</span>score <span style="color:#75715e"># 60    实际转化为s.get_score()</span>
s<span style="color:#f92672">.</span>score <span style="color:#f92672">=</span> <span style="color:#ae81ff">999</span> <span style="color:#75715e"># ValueError : score must between 0 ~ 100</span>
</code></pre></div><p>可以定义只读属性，只定义getter方法，不定义setter方法就是一个只读属性:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):

    <span style="color:#a6e22e">@property</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">birth</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_birth
    
    <span style="color:#a6e22e">@birth.setter</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">birth</span>(self, value):
        self<span style="color:#f92672">.</span>_birth <span style="color:#f92672">=</span> value

    <span style="color:#a6e22e">@property</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">age</span>(self):
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2015</span><span style="color:#f92672">-</span>self<span style="color:#f92672">.</span>_birth
</code></pre></div><p>上面的<code>birth</code>是可读写属性，而<code>age</code>就是一个只读属性，因为<code>age</code>可以根据当前<code>birth</code>和当前时间计算出来</p>
<h2 id="多重继承">多重继承</h2>
<p>简单来说就是可以继承多个父类，避免分类方式增加时出现指数型增长
example:<br>
按照哺乳动物分类</p>
<ul>
<li>Animal
<ul>
<li>Mammal(哺乳动物)
<ul>
<li>Dog</li>
<li>Bat</li>
</ul>
</li>
<li>Bird(鸟类)
<ul>
<li>Parrot(鹦鹉)</li>
<li>Ostrich(鸵鸟)
按照能跑和能飞来分类</li>
</ul>
</li>
</ul>
</li>
<li>Animal
<ul>
<li>Runnable
<ul>
<li>Dog</li>
<li>Ostrich</li>
</ul>
</li>
<li>Flyable
<ul>
<li>Parrot</li>
<li>Bat
如果要把上面的两种分类都包含进来，我们需要设计更多的层次</li>
</ul>
</li>
</ul>
</li>
<li>Animal
<ul>
<li>Mammal
<ul>
<li>MRun
<ul>
<li>Dog</li>
</ul>
</li>
<li>MFly
<ul>
<li>Bat</li>
</ul>
</li>
</ul>
</li>
<li>Bird
<ul>
<li>BRun
<ul>
<li>Ostrich</li>
</ul>
</li>
<li>BFly
<ul>
<li>Parrot</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>如果还要增加其他分类，类的数量会呈指数增长，很明显这样问题很大，正确的做法是采用多重继承</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Animal</span>(object):
    <span style="color:#66d9ef">pass</span>

<span style="color:#75715e"># 大类</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Mammal</span>(Animal):
    <span style="color:#66d9ef">pass</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bird</span>(Animal):
    <span style="color:#66d9ef">pass</span>

<span style="color:#75715e"># 各种动物</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dog</span>(Mammal):
    <span style="color:#66d9ef">pass</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bat</span>(Mammal):
    <span style="color:#66d9ef">pass</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Parrot</span>(Bird):
    <span style="color:#66d9ef">pass</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Ostrich</span>(Bird):
    <span style="color:#66d9ef">pass</span>
</code></pre></div><p>现在我们要给动物加上<code>Runnable</code>和<code>Flyable</code>的功能，只需要定义好<code>Runnable</code>和<code>Flyable</code>的类：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Runnable</span>(object):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Running...&#39;</span>)

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Flyable</span>(object):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fly</span>(self):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Flying...&#39;</span>)
</code></pre></div><p>对于需要<code>Runnable</code>功能的动物，就多继承一个<code>Runnable</code>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dog</span>(Mammal, Runnable):
    <span style="color:#66d9ef">pass</span>
</code></pre></div><p>对于需要<code>Flyable</code>功能的动，就多继承一个<code>Flyable</code>，例如<code>Bat</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bat</span>(Mammal, Flyable):
    <span style="color:#66d9ef">pass</span>
</code></pre></div><p>通过多重继承，一个子类就可以同时获得父类的所有功能<br>
在设计类的继承关系时，通常，诛仙都是单一继承下来的，例如，<code>Ostrich</code>继承自<code>Bird</code>。但是，如果需要“混入”额外的功能，通过多重继承就可以实现，比如，让<code>OStrich</code>除了继承自<code>Bird</code>外，再同时继承<code>Runnable</code>。这种设计通常称之为<code>MixIn</code>。</p>
<p>为了更好地看出继承关系，我们把<code>Runnable</code>和<code>Flyable</code>改为<code>RunnableMixIn</code>和<code>FlyableMixIn</code>。类似的，你还可以定义出肉食动物<code>CarnivorousMixIn</code>和植食动物<code>HerbivoresMixIn</code>，让某个动物同时拥有好几个MixIn：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dog</span>(Mammal, RunnableMixIn, CarnivorousMixIn):
    <span style="color:#66d9ef">pass</span>
</code></pre></div><p>MixIn的目的就是给一个类增加多个功能，这样，在设计类的时候，我们优先考虑通过多重继承来组合多个MixIn的功能，而不是设计多层次的继承关系。<br>
Python自带了<code>TCPServer</code>和<code>UDPServer</code>这两类网络服务，而要同时服务多个用户就必须使用多进程或多线程模型，这两种模型由<code>ForkingMixIn</code>和<code>ThreadingMixIn</code>提供。通过组合，我们就可以创造出合适的服务来。</p>
<p>比如，编写一个多进程模式的TCP服务，定义如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyTCPServer</span>(TCPSercer, ForkingMixIn):
    <span style="color:#66d9ef">pass</span>
</code></pre></div><p>编写一个多线程模式的UDP服务，定义如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyUDPServer</span>(UDPServer, ThreadingMixIn):
    <span style="color:#66d9ef">pass</span>
</code></pre></div><p>这样一来，我们不需要复杂而庞大的继承链，只要选择组合不同的类的功能，就可以快速构造出所需的子类。</p>
<h2 id="定制类">定制类</h2>
<p>看到类似<code>__slots__</code>这种形如<code>__xxx__</code>的变量或者函数名要想到，这些是在Python中是有特殊作用的。<br>
前面已经学过了<code>__slots__</code>我们已经知道怎么用了，<code>__len()__</code>方法我们也是知道为了能让class作用于<code>len()</code>函数。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self, name):
        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> name 
<span style="color:#66d9ef">print</span>(Student(<span style="color:#e6db74">&#39;LuoKey&#39;</span>))
<span style="color:#75715e"># &gt;&gt;&gt; &lt;__main__.Student object at 0x0000000003CA9F60&gt;</span>
</code></pre></div><p>这样打印出来不好看？只需要定义好<code>__str__()</code>方法，返回一个字符串就可以了：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self, name):
        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> name
    <span style="color:#66d9ef">def</span> __str__(self):
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Student object (name ：</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span>self<span style="color:#f92672">.</span>name
<span style="color:#66d9ef">print</span>(Student(<span style="color:#e6db74">&#39;Luokey&#39;</span>))
<span style="color:#75715e"># &gt;&gt;&gt; Student object (name ：Luokey)</span>
<span style="color:#75715e"># but</span>
s <span style="color:#75715e"># &lt;__main__.Student object at 0x00000000024FF6D8&gt;</span>
</code></pre></div><p>上面s显示变量调用的不是<code>__str__()</code>，而是<code>__repr__()</code>，两者的区别是<code>___str__()</code>返回用户看到的字符串，而<code>__repr__()</code>返回程序开发者看到的字符串，也就是说，<code>__repr__()</code>是为调试服务的。</p>
<p>解决的办法是再定义一个<code>__repr__()</code>。但是通常<code>__str__()</code>和<code>__repr__()</code>代码都是一样的，所以，有个偷懒的写法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self, name):
        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> name
    <span style="color:#66d9ef">def</span> __str__(self):
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Student object (name = </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span>s self<span style="color:#f92672">.</span>name
    __repr__ <span style="color:#f92672">=</span> __str__
</code></pre></div><h3 id="__iter__"><code>__iter__</code></h3>
<p>如果一个类想被用于<code>for ... in</code>循环，类似list或tuple那样，就必须实现一个<code>__iter__()</code>方法，该方法返回一个迭代对象，然后，Python的for循环就会不断调用该迭代对象的<code>__next__()</code>方法拿到循环的下一个值，知道遇到<code>StopIteration</code>错误时退出循环。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 写一个Fib类</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fib</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>a, slef,b <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span> <span style="color:#75715e"># 初始化两个计数器a, b</span>
    <span style="color:#66d9ef">def</span> __iter__(self):
        <span style="color:#66d9ef">return</span> self <span style="color:#75715e"># 实例本身就是迭代对象，故返回自己</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__next__</span>(self):
        self<span style="color:#f92672">.</span>a, self<span style="color:#f92672">.</span>b <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>b, self<span style="color:#f92672">.</span>a <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>b <span style="color:#75715e">#计算下一个值</span>
        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>a <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">100000</span>: <span style="color:#75715e"># 退出循环的条件</span>
            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">StopIteration</span>
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>a <span style="color:#75715e"># 返回下一个值</span>

<span style="color:#75715e"># 测试:</span>
<span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> Fib():
    <span style="color:#66d9ef">print</span>(n)
<span style="color:#75715e"># 1</span>
<span style="color:#75715e"># 1</span>
<span style="color:#75715e"># 2</span>
<span style="color:#75715e"># 3</span>
<span style="color:#75715e"># ...</span>
<span style="color:#75715e"># 46368</span>
<span style="color:#75715e"># 75025</span>

<span style="color:#75715e"># 试图获取第5个元素</span>
Fib()[<span style="color:#ae81ff">5</span>]
<span style="color:#75715e"># TypeError:&#39;Fib&#39; object does not support indexing</span>
</code></pre></div><p>虽然像list，但是终究不能当list用，我们需要实现<code>__getitem__()</code>方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fib</span>(object):
    <span style="color:#66d9ef">def</span> __getitem__(self, n):
        a, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(n):
            a, b <span style="color:#f92672">=</span> b, a <span style="color:#f92672">+</span> b
        <span style="color:#66d9ef">return</span> a
f <span style="color:#f92672">=</span> Fib()
f[<span style="color:#ae81ff">0</span>] <span style="color:#75715e"># 1</span>
f[<span style="color:#ae81ff">100</span>] <span style="color:#75715e">#　573147844013817084101</span>
</code></pre></div><p>list有个神奇的切片方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">list(range(<span style="color:#ae81ff">100</span>))[<span style="color:#ae81ff">5</span>:<span style="color:#ae81ff">10</span>]
<span style="color:#75715e"># [5,6,7,8,9]</span>
</code></pre></div><p>但是Fib会报错，因为<code>__getitem__()</code>传入的可能是一个int，也可能是一个切片对象<code>slice</code>，所以要判断：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fib</span>(object):
    <span style="color:#66d9ef">def</span> __getitem__(self, n):
        <span style="color:#66d9ef">if</span> isinstance(n, int): <span style="color:#75715e"># n is an index</span>
            a, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>
            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(n):
                a, b <span style="color:#f92672">=</span> b, a<span style="color:#f92672">+</span>b
            <span style="color:#66d9ef">return</span> a
        <span style="color:#66d9ef">if</span> isinstance(n, slice): <span style="color:#75715e"># n is a slice</span>
            start <span style="color:#f92672">=</span> n<span style="color:#f92672">.</span>start
            stop  <span style="color:#f92672">=</span> n<span style="color:#f92672">.</span>stop
            <span style="color:#66d9ef">if</span> start <span style="color:#f92672">is</span> None:
                start <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
            a, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>
            L <span style="color:#f92672">=</span> []
            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(stop):
                <span style="color:#66d9ef">if</span> x <span style="color:#f92672">&gt;=</span> start:
                    L<span style="color:#f92672">.</span>append(a)
                a, b <span style="color:#f92672">=</span> b, a<span style="color:#f92672">+</span>b
            <span style="color:#66d9ef">return</span> L

f <span style="color:#f92672">=</span> Fib()
f[:<span style="color:#ae81ff">5</span>] <span style="color:#75715e"># [1, 1, 2, 3, 5]</span>
</code></pre></div><p>但是没有对step参数做处理，也没有对附属作处理，所以要正确实现一个<code>__getitem__()</code>还有很多工作要做</p>
<h3 id="__getattr__"><code>__getattr__</code></h3>
<p>正常情况下，当我们调用类的方法或属性时，如果不存在，就会报错。比如:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):

    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Michael&#39;</span>
s <span style="color:#f92672">=</span> Student()
<span style="color:#66d9ef">print</span>(s<span style="color:#f92672">.</span>name)
<span style="color:#75715e"># &gt;&gt;&gt; Miclael</span>
<span style="color:#66d9ef">print</span>(s<span style="color:#f92672">.</span>score)
<span style="color:#75715e"># &gt;&gt;&gt; AttributeError: &#39;Student&#39; object has no attribute &#39;score&#39; </span>
</code></pre></div><p>我们可以写一个<code>__getattr__()</code>方法，动态返回一个属性，如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Luokey&#39;</span>
    
    <span style="color:#66d9ef">def</span> __getattr__(self, attr):
        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;attr&#39;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;score&#39;</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">99</span>
</code></pre></div><p>当调用不存在的属性时，Python解释器就会试图调用<code>__getattr__(self, attr)</code>来尝试获得属性：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">s <span style="color:#f92672">=</span> Student()
s<span style="color:#f92672">.</span>name <span style="color:#75715e"># &#39;Luokey&#39;</span>
s<span style="color:#f92672">.</span>score <span style="color:#75715e"># 99</span>
</code></pre></div><p>当然也可以返回函数：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__getattr</span>(self, attr):
        <span style="color:#66d9ef">if</span> attr <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;age&#39;</span>:
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">lambda</span>: <span style="color:#ae81ff">25</span>

<span style="color:#75715e"># 调用时会有区别</span>
s<span style="color:#f92672">.</span>age() <span style="color:#75715e"># 25</span>
</code></pre></div><p>只有在没有找到属性的情况下，才会调用<code>__getattr__</code>，已有的属性不会在<code>__getattr__</code>中查找，没有的属性，且在<code>__getattr__</code>中也没有，会默认返回<code>None</code>，可以修改：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):

    <span style="color:#66d9ef">def</span> __getattr__(self, attr):
        <span style="color:#66d9ef">if</span> attr <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;age&#39;</span>:
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">25</span>
        <span style="color:#66d9ef">elif</span> attr <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;score&#39;</span>:
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">147</span>
        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">AttributeError</span>(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">Student</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74"> object has no attribute </span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> attr)
</code></pre></div><h3 id="__call__"><code>__call__</code></h3>
<p>一个对象实例可以有自己的属性和方法，当我们调用实例方法时，我们用<code>instance.method()</code>来调用。能不能直接在实例本身上调用呢？可以，需要<code>__call__()</code>方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self, name):
        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> name

    <span style="color:#66d9ef">def</span> __call__(self):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;My name is </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">.&#39;</span><span style="color:#f92672">%</span>self<span style="color:#f92672">.</span>name)
s <span style="color:#f92672">=</span> Student(<span style="color:#e6db74">&#39;Luokey&#39;</span>)
s()
<span style="color:#75715e"># &gt;&gt;&gt; My name is Luokey</span>
</code></pre></div><p>我们要怎么判断一个对象是否可以被调用呢，能被调用的对象是一个<code>Callable</code>对象：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">callable(s) <span style="color:#75715e"># True</span>
callable(Student) <span style="color:#75715e"># True</span>
callable(max) <span style="color:#75715e"># True</span>
callable(None) <span style="color:#75715e"># False</span>
callable(<span style="color:#e6db74">&#39;str&#39;</span>) <span style="color:#75715e"># False</span>
callable([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]) <span style="color:#75715e"># False</span>
</code></pre></div><h2 id="枚举类">枚举类</h2>
<p>当我们定义常量的时候，一个办法是用大写变量通过证整数来定义：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">JAN <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
FEB <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
MAR <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
<span style="color:#f92672">...</span>
NOV <span style="color:#f92672">=</span> <span style="color:#ae81ff">11</span>
DEC <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>
</code></pre></div><p>虽然简单，但类型是<code>int</code>，并且实际上仍然是变量。<br>
更好的方法是为这样的枚举类型定义一个class类型，每个场地昂都是class的唯一一个实例。Python提供了<code>Enum</code>类来实现：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> enum <span style="color:#f92672">import</span> Enum

Month <span style="color:#f92672">=</span> Enum(<span style="color:#e6db74">&#39;Month&#39;</span>,(<span style="color:#e6db74">&#39;Jan&#39;</span>,<span style="color:#e6db74">&#39;Feb&#39;</span>,<span style="color:#e6db74">&#39;Mar&#39;</span>,<span style="color:#e6db74">&#39;Apr&#39;</span>,<span style="color:#e6db74">&#39;May&#39;</span>,<span style="color:#e6db74">&#39;Jun&#39;</span>,<span style="color:#e6db74">&#39;Jul&#39;</span>,<span style="color:#e6db74">&#39;Aug&#39;</span>,<span style="color:#e6db74">&#39;Sep&#39;</span>,<span style="color:#e6db74">&#39;Oct&#39;</span>,<span style="color:#e6db74">&#39;Nov&#39;</span>,<span style="color:#e6db74">&#39;Dec&#39;</span>))
<span style="color:#66d9ef">for</span> name, member <span style="color:#f92672">in</span> Month<span style="color:#f92672">.</span>__members__<span style="color:#f92672">.</span>items():
    <span style="color:#66d9ef">print</span>(name,<span style="color:#e6db74">&#39;=&gt;&#39;</span>,member,<span style="color:#e6db74">&#39;,&#39;</span>,member<span style="color:#f92672">.</span>value)
<span style="color:#75715e"># &gt;&gt;&gt;</span>
<span style="color:#75715e"># Jan =&gt; Month.Jan , 1</span>
<span style="color:#75715e"># Feb =&gt; Month.Feb , 2</span>
<span style="color:#75715e"># Mar =&gt; Month.Mar , 3</span>
<span style="color:#75715e"># Apr =&gt; Month.Apr , 4</span>
<span style="color:#75715e"># May =&gt; Month.May , 5</span>
<span style="color:#75715e"># Jun =&gt; Month.Jun , 6</span>
<span style="color:#75715e"># Jul =&gt; Month.Jul , 7</span>
<span style="color:#75715e"># Aug =&gt; Month.Aug , 8</span>
<span style="color:#75715e"># Sep =&gt; Month.Sep , 9</span>
<span style="color:#75715e"># Oct =&gt; Month.Oct , 10</span>
<span style="color:#75715e"># Nov =&gt; Month.Nov , 11</span>
<span style="color:#75715e"># Dec =&gt; Month.Dec , 12</span>
</code></pre></div><h2 id="待解决问题">待解决问题</h2>
<ul>
<li>不可变对象问题</li>
</ul>
<blockquote>
<p><a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1017104324028448">https://www.liaoxuefeng.com/wiki/1016959663602400/1017104324028448</a></p>
</blockquote>
<ul>
<li>dict.get(str, value)错误问题</li>
<li>尾递归优化不太清楚</li>
<li>汉诺塔问题不熟</li>
<li>List Comprehensions 的条件使用环境</li>
<li>模块部分</li>
</ul>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
</body>

</html>